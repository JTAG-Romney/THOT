<!DOCTYPE html>

<html>
<head>
  <title>thotplayer.js</title>
  <meta http-equiv="content-type" content="text/html; charset=UTF-8">
  <meta name="viewport" content="width=device-width, target-densitydpi=160dpi, initial-scale=1.0; maximum-scale=1.0; user-scalable=0;">
  <link rel="stylesheet" media="all" href="docco.css" />
</head>
<body>
  <div id="container">
    <div id="background"></div>
    
      <ul id="jump_to">
        <li>
          <a class="large" href="javascript:void(0);">Jump To &hellip;</a>
          <a class="small" href="javascript:void(0);">+</a>
          <div id="jump_wrapper">
          <div id="jump_page_wrapper">
            <div id="jump_page">
              
                
                <a class="source" href="id3.html">
                  id3.js
                </a>
              
                
                <a class="source" href="thotplayer.html">
                  thotplayer.js
                </a>
              
                
                <a class="source" href="txtwiki.html">
                  txtwiki.js
                </a>
              
            </div>
          </div>
        </li>
      </ul>
    
    <ul class="sections">
        
          <li id="title">
              <div class="annotation">
                  <h1>thotplayer.js</h1>
              </div>
          </li>
        
        
        
        <li id="section-1">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-1">&#182;</a>
              </div>
              <p>~ Block console.info
~ console.info = function() {}</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>
<span class="hljs-comment">/*** 
 * THOT | This HTML Orgasmic Turntable
 * Dual deck audio player with crossfader and dual 7 bands Equalizer
 * Find songs in many local folders to organize a random playlist
 * Full keyboard controls
 ***
 *  Nico KraZhtest | 2017 | ponyhacks.com
 ***
 * Keyboard events (Azerty):
 * ------------------------*
 * Space bar: Play random track with fader automation
 *-- 
 * [Ctrl+Enter]:  Open deckA file manager 
 * [Shift+Enter]: Open deckB file manager
 *--
 * [,]: Random track on both decks
 * [;]: Random Track deck A 
 * [:]: Random Track deck B
 * [!]: Copy deckA track to deckB
 *--
 * [a/z]: Slider track automations with delays
 *--
 * [Ctrl+!]:  Copy deckA track to deckB
 * [Shift+!]: Copy deckB track to deckA
 *--
 * [Ctrl+Left/Right]: Main Slider left/right 
 * [Alt+Up/Down]:     Main Slider switch
 * [Ctrl+Up/Down]:    Ratio slider up/down 
 * [Alt+Up/Down]:     Ratio slider switch
 *--
 ***
 * Basic usage from js:
 * Check the current playlist tracks array
 * list
 * 
 * Or for the third track:
 * list[2]
 * 
 * Add track to playlist. 
 * (Accept both local, network, or blub url)
 * list.push("")
 * 
 * Check the current playlist index 
 * playlist
 * 
 * Random tracks
 * trackRandom()
 * trackRandomA()
 * trackRandomB()
 * 
 * Play the playlist numbered 13 on deckA:
 * deckA.src = list[13]
 * 
 * Fade automation from the deck B to A in 35 seconds 
 * autoDeckA(350)
 * 
 * Show the Equalizer:
 * showEq("off")
 * showEq("on")
 * 
 * Poster animation pause:
 * posterPause("on")
 * posterPause("off")
 * 
 * */</span>
<span class="hljs-meta">'use strict'</span></pre></div></div>
            
        </li>
        
        
        <li id="section-2">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-2">&#182;</a>
              </div>
              <p>css <link rel="stylesheet" href="css/style.css"></p>

            </div>
            
            <div class="content"><div class='highlight'><pre><span class="hljs-keyword">var</span> targtCss = <span class="hljs-built_in">document</span>.getElementsByTagName(<span class="hljs-string">'*'</span>)[<span class="hljs-number">1</span>],
injCss = <span class="hljs-built_in">document</span>.createElement(<span class="hljs-string">'link'</span>)
injCss.rel = <span class="hljs-string">"stylesheet"</span>
injCss.href = <span class="hljs-string">'https://ponyhacks.com/open/apps/player/css/thot.css'</span>
targtCss.appendChild(injCss)</pre></div></div>
            
        </li>
        
        
        <li id="section-3">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-3">&#182;</a>
              </div>
              <p>We need to create a container to hold</p>

            </div>
            
            <div class="content"><div class='highlight'><pre><span class="hljs-keyword">let</span> sp = <span class="hljs-built_in">document</span>.createElement(<span class="hljs-string">"SPAN"</span>)</pre></div></div>
            
        </li>
        
        
        <li id="section-4">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-4">&#182;</a>
              </div>
              <p>Our audio player</p>

            </div>
            
            <div class="content"><div class='highlight'><pre><span class="hljs-keyword">let</span> a = <span class="hljs-built_in">document</span>.createElement(<span class="hljs-string">"audio"</span>)</pre></div></div>
            
        </li>
        
        
        <li id="section-5">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-5">&#182;</a>
              </div>
              <p>They will need some buttons to evolve in the playlist</p>

            </div>
            
            <div class="content"><div class='highlight'><pre><span class="hljs-keyword">let</span> deckAnext = <span class="hljs-built_in">document</span>.createElement(<span class="hljs-string">"button"</span>)
<span class="hljs-keyword">let</span> deckAlast = <span class="hljs-built_in">document</span>.createElement(<span class="hljs-string">"button"</span>)
<span class="hljs-keyword">let</span> deckBnext = <span class="hljs-built_in">document</span>.createElement(<span class="hljs-string">"button"</span>)
<span class="hljs-keyword">let</span> deckBlast = <span class="hljs-built_in">document</span>.createElement(<span class="hljs-string">"button"</span>)
deckAnext.className = <span class="hljs-string">"media deckplaylist deckAnext"</span>
deckAlast.className = <span class="hljs-string">"media deckplaylist deckAlast"</span>
deckBnext.className = <span class="hljs-string">"media deckplaylist deckBnext"</span>
deckBlast.className = <span class="hljs-string">"media deckplaylist deckBlast"</span></pre></div></div>
            
        </li>
        
        
        <li id="section-6">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-6">&#182;</a>
              </div>
              <p>Give user control power</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>a.setAttribute(<span class="hljs-string">"controls"</span>, <span class="hljs-string">""</span>)</pre></div></div>
            
        </li>
        
        
        <li id="section-7">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-7">&#182;</a>
              </div>
              <p>Random track on track end</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>a.setAttribute(<span class="hljs-string">"onended"</span>, <span class="hljs-string">"trackRandomA()"</span>)</pre></div></div>
            
        </li>
        
        
        <li id="section-8">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-8">&#182;</a>
              </div>
              <p>Random track if error</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>a.setAttribute(<span class="hljs-string">"onerror"</span>, <span class="hljs-string">"trackRandomA()"</span>)</pre></div></div>
            
        </li>
        
        
        <li id="section-9">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-9">&#182;</a>
              </div>
              <p>We need an attribute container for the title</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>a.setAttribute(<span class="hljs-string">"data-track"</span>, <span class="hljs-string">""</span>)</pre></div></div>
            
        </li>
        
        
        <li id="section-10">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-10">&#182;</a>
              </div>
              <p>When datas are loaded, display the track title, then start the player</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>a.setAttribute(<span class="hljs-string">"onloadeddata"</span>, <span class="hljs-string">"trackNameA()"</span>)
a.setAttribute(<span class="hljs-string">"ondurationchange"</span>, <span class="hljs-string">"trackNameA()"</span>)</pre></div></div>
            
        </li>
        
        
        <li id="section-11">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-11">&#182;</a>
              </div>
              <p>Allow tracks to be dropped</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>a.setAttribute(<span class="hljs-string">"ondrop"</span>, <span class="hljs-string">"drop(event)"</span>)
a.setAttribute(<span class="hljs-string">"ondragover"</span>, <span class="hljs-string">"allowDrop(event)"</span>)</pre></div></div>
            
        </li>
        
        
        <li id="section-12">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-12">&#182;</a>
              </div>
              <p>Blink a led if a track is a playing</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>a.setAttribute(<span class="hljs-string">"onplaying"</span>, <span class="hljs-string">"ledAcheck();notifTrack(deckA)"</span>)</pre></div></div>
            
        </li>
        
        
        <li id="section-13">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-13">&#182;</a>
              </div>
              <p>Check blink state in case of seeking </p>

            </div>
            
            <div class="content"><div class='highlight'><pre>a.setAttribute(<span class="hljs-string">"onseeked"</span>, <span class="hljs-string">"ledAcheck()"</span>)
a.setAttribute(<span class="hljs-string">"ontimeupdate"</span>, <span class="hljs-string">"ledAcheck()"</span>)</pre></div></div>
            
        </li>
        
        
        <li id="section-14">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-14">&#182;</a>
              </div>
              <p>If paused stop the led </p>

            </div>
            
            <div class="content"><div class='highlight'><pre>a.setAttribute(<span class="hljs-string">"onpause"</span>, <span class="hljs-string">"ledA.className = 'led_off'"</span>)</pre></div></div>
            
        </li>
        
        
        <li id="section-15">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-15">&#182;</a>
              </div>
              <p>Now let’s name our nice audio object, to later call him</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>a.id = <span class="hljs-string">"deckA"</span></pre></div></div>
            
        </li>
        
        
        <li id="section-16">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-16">&#182;</a>
              </div>
              <p>A css class, to style both players</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>a.className = <span class="hljs-string">"dropzone"</span></pre></div></div>
            
        </li>
        
        
        <li id="section-17">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-17">&#182;</a>
              </div>
              <p>Yeah! We need two players to make pony mixes!
So let’s create another one:</p>

            </div>
            
            <div class="content"><div class='highlight'><pre><span class="hljs-keyword">let</span> deckB = <span class="hljs-built_in">document</span>.createElement(<span class="hljs-string">"audio"</span>)
    deckB.setAttribute(<span class="hljs-string">"controls"</span>, <span class="hljs-string">""</span>)
    deckB.setAttribute(<span class="hljs-string">"onerror"</span>, <span class="hljs-string">"trackRandomB()"</span>)
    deckB.setAttribute(<span class="hljs-string">"onended"</span>, <span class="hljs-string">"trackRandomB()"</span>)
    deckB.setAttribute(<span class="hljs-string">"data-track"</span>, <span class="hljs-string">""</span>)
    deckB.setAttribute(<span class="hljs-string">"onloadeddata"</span>, <span class="hljs-string">"trackNameB()"</span>)
    deckB.setAttribute(<span class="hljs-string">"ondurationchange"</span>, <span class="hljs-string">"trackNameB()"</span>)
    deckB.setAttribute(<span class="hljs-string">"ondrop"</span>, <span class="hljs-string">"drop(event)"</span>)
    deckB.setAttribute(<span class="hljs-string">"ondragover"</span>, <span class="hljs-string">"allowDrop(event)"</span>)
    deckB.setAttribute(<span class="hljs-string">"onplaying"</span>, <span class="hljs-string">"ledBcheck();notifTrack(deckB)"</span>)
    deckB.setAttribute(<span class="hljs-string">"onseeked"</span>, <span class="hljs-string">"ledBcheck()"</span>)
    deckB.setAttribute(<span class="hljs-string">"ontimeupdate"</span>, <span class="hljs-string">"ledBcheck()"</span>)
    deckB.setAttribute(<span class="hljs-string">"onpause"</span>, <span class="hljs-string">"ledB.className = 'led_off'"</span>)
    deckB.className = <span class="hljs-string">"dropzone"</span>
    deckB.id = <span class="hljs-string">"deckB"</span></pre></div></div>
            
        </li>
        
        
        <li id="section-18">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-18">&#182;</a>
              </div>
              <p>Now we need to inject our players in the document
Let’s focus anywhere, like the first html <div></p>

            </div>
            
            <div class="content"><div class='highlight'><pre><span class="hljs-keyword">let</span> target = <span class="hljs-built_in">document</span>.getElementsByTagName(<span class="hljs-string">"*"</span>)[<span class="hljs-number">0</span>]

<span class="hljs-keyword">let</span> mixer = <span class="hljs-built_in">document</span>.createElement(<span class="hljs-string">"div"</span>)
mixer.className = <span class="hljs-string">"main"</span>
mixer.innerHTML = <span class="hljs-string">`
&lt;div class="mixer" draggable&gt;
 &lt;!-- Deck A --&gt;
 &lt;div class="left"&gt;
&lt;form&gt;
    &lt;input type="range" id="lowGainKnob" data-wait="0" class="mix" value="50" step="1"
     min="0" max="100" oncontextmenu="if(this.dataset.wait=='0'){this.dataset.wait='1';this.className = 'mix invertalert';holdEq(this.id)}else{this.dataset.wait='0';this.className = 'mix stop'}return false" oninput="changeGain(this.value, 'lowGain');mirrorEq(this.id,this.value)" /&gt;
    &lt;input type="range" id="lowGain02Knob" data-wait="0" class="mix" value="50" step="1"
     min="0" max="100" oncontextmenu="if(this.dataset.wait=='0'){this.dataset.wait='1';this.className = 'mix invertalert';holdEq(this.id)}else{this.dataset.wait='0';this.className = 'mix stop'};return false" oninput="changeGain(this.value, 'lowGain02');mirrorEq(this.id,this.value)" /&gt;
    &lt;input type="range" id="lowGain03Knob" data-wait="0" class="mix" value="50" step="1"
     min="0" max="100" oncontextmenu="if(this.dataset.wait=='0'){this.dataset.wait='1';this.className = 'mix invertalert';holdEq(this.id)}else{this.dataset.wait='0';this.className = 'mix stop'};return false" oninput="changeGain(this.value, 'lowGain03');mirrorEq(this.id,this.value)" /&gt;
    &lt;input id="mid" data-wait="0" type="range" value="0" class="mix" step="0.1" min="3"
     max="7" oncontextmenu="if(this.dataset.wait=='0'){this.dataset.wait='1';this.className = 'mix invertalert';holdEq(this.id)}else{this.dataset.wait='0';this.className = 'mix stop'};return false" oninput="changeGain(this.value, 'midGain');mirrorEq(this.id,this.value)" /&gt;
    &lt;input type="range" id="highGain05Knob" data-wait="0" class="mix" value="50" step="1"
     min="0" max="100" oncontextmenu="if(this.dataset.wait=='0'){this.dataset.wait='1';this.className = 'mix invertalert';holdEq(this.id)}else{this.dataset.wait='0';this.className = 'mix stop'};return false" oninput="changeGain(this.value, 'highGain05');mirrorEq(this.id,this.value)" /&gt;
    &lt;input type="range" id="highGain06Knob" data-wait="0" class="mix" value="50" step="1"
     min="0" max="100" oncontextmenu="if(this.dataset.wait=='0'){this.dataset.wait='1';this.className = 'mix invertalert';holdEq(this.id)}else{this.dataset.wait='0';this.className = 'mix stop'};return false" oninput="changeGain(this.value, 'highGain06');mirrorEq(this.id,this.value)" /&gt;
    &lt;input type="range" id="highGainKnob" data-wait="0" class="mix" value="50" step="1"
     min="0" max="100" oncontextmenu="if(this.dataset.wait=='0'){this.dataset.wait='1';this.className = 'mix invertalert';holdEq(this.id)}else{this.dataset.wait='0';this.className = 'mix stop'};return false" oninput="changeGain(this.value, 'highGain');mirrorEq(this.id,this.value)" /&gt;
&lt;/form&gt;
 &lt;/div&gt;

 &lt;!-- Deck B --&gt;
 &lt;div&gt;
     
 &lt;form class="mixRight"&gt;
    &lt;!-- &lt;label&gt;Low Gain&lt;/label&gt; --&gt;
    &lt;input type="range" id="lowGainKnob_deckB" data-wait="0" class="mixreversed" value="50"
     step="1" min="0" max="100" oncontextmenu="if(this.dataset.wait=='0'){this.dataset.wait='1';this.className = 'mixreversed invertalert';holdEq(this.id)}else{this.dataset.wait='0';this.className = 'mixreversed stop'};return false" oninput="changeGaindeckb(this.value, 'lowGain');mirrorEq(this.id,this.value)" /&gt;
    &lt;input type="range" id="lowGain02Knob_deckB" data-wait="0" class="mixreversed" value="50"
     step="1" min="0" max="100" oncontextmenu="if(this.dataset.wait=='0'){this.dataset.wait='1';this.className = 'mixreversed invertalert';holdEq(this.id)}else{this.dataset.wait='0';this.className = 'mixreversed stop'};return false" oninput="changeGaindeckb(this.value, 'lowGain02');mirrorEq(this.id,this.value)" /&gt;
    &lt;input type="range" id="lowGain03Knob_deckB" data-wait="0" class="mixreversed" value="50"
     step="1" min="0" max="100" oncontextmenu="if(this.dataset.wait=='0'){this.dataset.wait='1';this.className = 'mixreversed invertalert';holdEq(this.id)}else{this.dataset.wait='0';this.className = 'mixreversed stop'};return false" oninput="changeGaindeckb(this.value, 'lowGain03');mirrorEq(this.id,this.value)" /&gt;
    &lt;input id="mid_deckB" type="range" value="400" data-wait="0" class="mixreversed" step="5"
     min="1" max="600" oncontextmenu="if(this.dataset.wait=='0'){this.dataset.wait='1';this.className = 'mixreversed invertalert';holdEq(this.id)}else{this.dataset.wait='0';this.className = 'mixreversed stop'};return false" oninput="changeGaindeckb(this.value, 'midGain');mirrorEq(this.id,this.value)" /&gt;
    &lt;input type="range" id="highGain05Knob_deckB" data-wait="0" class="mixreversed" value="50"
     step="1" min="0" max="400" oncontextmenu="if(this.dataset.wait=='0'){this.dataset.wait='1';this.className = 'mixreversed invertalert';holdEq(this.id)}else{this.dataset.wait='0';this.className = 'mixreversed stop'};return false" oninput="changeGaindeckb(this.value, 'highGain05');mirrorEq(this.id,this.value)" /&gt;
    &lt;input type="range" id="highGain06Knob_deckB" data-wait="0" class="mixreversed" value="50"
     step="1" min="0" max="400" oncontextmenu="if(this.dataset.wait=='0'){this.dataset.wait='1';this.className = 'mixreversed invertalert';holdEq(this.id)}else{this.dataset.wait='0';this.className = 'mixreversed stop'};return false" oninput="changeGaindeckb(this.value, 'highGain06');mirrorEq(this.id,this.value)" /&gt;
    &lt;input type="range" id="highGainKnob_deckB" data-wait="0" class="mixreversed" value="50"
     step="1" min="0" max="400" oncontextmenu="if(this.dataset.wait=='0'){this.dataset.wait='1';this.className = 'mixreversed invertalert';holdEq(this.id)}else{this.dataset.wait='0';this.className = 'mixreversed stop'};return false" oninput="changeGaindeckb(this.value, 'highGain');mirrorEq(this.id,this.value)" /&gt;
&lt;/form&gt;
  &lt;/div&gt;
    &lt;/div&gt;
 &lt;br&gt;
   &lt;br&gt;
&lt;div class="ctrlBlock"&gt;&lt;/div&gt;
&lt;!-- Slider --&gt;
&lt;form class="slider" id="sliderForm"&gt;
 &lt;input type="range" id="sliderTracks" name="slidertracks" 
   oninput="fadeTracks()" oncontextmenu="clearAutomation();return false" title="Right click to reset all automation" value="0" step="1" min="1" max="99" /&gt;
 &lt;input type="range" oninput="fadeTracks()" id="sliderTracksRatio" 
  value="5" step="5" min="5" max="400" /&gt;
&lt;/form&gt;
&lt;div class="files"&gt;
 &lt;form id="userfiles" method="POST" enctype="multipart/form-data" onchange="pwnColor()"&gt;
  &lt;input type="file" id="aud" name="trcka" onchange="tagA()" webkitdirectory /&gt;
  &lt;input type="file" id="audB" name="trckb" onchange="tagB()" accept="audio/*" webkitdirectory /&gt;
&lt;/form&gt;
 &lt;/div&gt;
&lt;div class="filesBlock"&gt;
 &lt;span id="trackA" class=""&gt;&lt;/span&gt; 
 &lt;span id="trackB" class=""&gt;&lt;/span&gt; 
&lt;br&gt;
&lt;/div&gt;

&lt;!-- Dice button --&gt;
&lt;button type="button" id="dice" onclick="return trackRandom();"&gt;🔀&lt;/button&gt;

&lt;button type="button" class="ctrlBb" onclick="return resetAll();"&gt;&amp;#7360;&lt;/button&gt;

&lt;button type="button" class="buttonshoweq" value="on" 
onclick="if(this.value=='off'){this.value='on'}else{this.value='off'};showEq(this.value);"&gt;
&amp;#128335;&lt;/button&gt;

&lt;button type="button" id="buttonNotif" class="active" value="on" 
onclick="if(this.value=='off'){this.value='on';this.className='active'}else{this.value='off';this.className=''}" title="Toggle notifications"&gt;&amp;#9748;&lt;/button&gt;

&lt;button type="button" id="buttonLyrics" onclick="checkNet();lyrics(deckA.src)" title="Search lyrics and more..."&gt;🖧&lt;/button&gt;

&lt;div id="offline"&gt;🖧&lt;/div&gt;

&lt;!-- Files lists--&gt;
&lt;ul id="listing" oninput="pwnColor()"&gt;&lt;/ul&gt;
&lt;ul id="listingB" oninput="pwnColor()"&gt;&lt;/ul&gt;

&lt;form onchange="localStorage.setItem('baseColor', color.value)"&gt;
    &lt;input type="color" type="text" name="color" value="#FFFFFF" id="pwnClr" 
    oninput="pwnColor()" /&gt;
&lt;/form&gt;
 &lt;/div&gt;
&lt;div class="poster" id="posterblock" onmouseleave="posterPause('off')"&gt;
 &lt;span id="posterA" class="filesblock" onmouseover="posterPause('on')"&gt;&lt;/span&gt; 
 &lt;span id="posterB" class="filesblockright"&gt;&lt;/span&gt; 
 &lt;/div&gt;

&lt;!--
 Firefox bug playbackRate and web audio api won't work
https://bugzilla.mozilla.org/show_bug.cgi?id=966247
--&gt;
&lt;form id="rateControls"&gt;
    &lt;span id="pitchAlab"&gt;1.000&lt;/span&gt;
    &lt;span id="pitchBlab"&gt;1.000&lt;/span&gt;
    
    &lt;input type="range" value="500" step="0.1" min="250" max="2000" id="pitchA"
     oninput="pitchAlab.innerHTML=(this.value/500).toFixed(3);\
     deckA.playbackRate=pitchAlab.innerHTML" oncontextmenu="javascript:this.value='500';\
     pitchAlab.innerHTML=(this.value/500).toFixed(3);\
     deckA.playbackRate=pitchAlab.innerHTML;return false;" 
     title="Deck A playback Rate | Right click to reset"&gt;
    &lt;input type="range" value="500" step="0.1" min="250" max="2000" id="pitchB"
    oninput="pitchBlab.innerHTML=(this.value/500).toFixed(3);\
    deckB.playbackRate=pitchBlab.innerHTML" oncontextmenu="javascript:this.value='500';\
    pitchBlab.innerHTML=(this.value/500).toFixed(3);\
    deckB.playbackRate=pitchBlab.innerHTML;return false;"
    title="Deck B playback Rate | Right click to reset"&gt;
&lt;/form&gt;

&lt;span class="bonjour" title="Toggle fullscreen"&gt;
    &lt;b&gt;𝄞&lt;/b&gt;
&lt;/span&gt;

&lt;span id="ledA" onclick="lyrics(deckA)"&gt;&lt;/span&gt;
&lt;span id="ledB" onclick="lyrics(deckB)"&gt;&lt;/span&gt;


&lt;div id="artist"&gt;yo&lt;/div&gt;
&lt;span id="closelyrics" onclick="document.documentElement.style.cssText += ' ;transform:translateY(0px)';fixScroll()"&gt;✖&lt;/span&gt;
&lt;button type="button" id="closeFlex" class="" value="on" 
onclick="if(this.value=='off'){this.value='on';this.className='active';artist.style.display = 'block'}else{this.value='off';this.className='';artist.style.display='flex'}" title="Display as flexboxes"&gt;⛭&lt;/button&gt;

&lt;div id="artistInfos" data-keyboard="on" onmouseover="this.dataset.keyboard='off';console.log('Keyboard: '+this.dataset.keyboard)" onmouseout="this.dataset.keyboard='on';console.log('Keyboard: '+this.dataset.keyboard)"&gt;
 &lt;form onsubmit='ajaxTrack(artistrack.value);return false'&gt;
  &lt;input id='artistrack' title="Artist - Track?" value='' /&gt;
   &lt;input hidden type='submit' /&gt;
 &lt;/form&gt;
&lt;/div&gt;
&lt;div id="artistArchives"&gt;
 &lt;/div&gt;

`</span></pre></div></div>
            
        </li>
        
        
        <li id="section-19">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-19">&#182;</a>
              </div>
              <p>Construct the DOM</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    target.appendChild(mixer)
    mixer.appendChild(deckAnext)
    mixer.appendChild(deckAlast)
    mixer.appendChild(deckBnext)
    mixer.appendChild(deckBlast)
    mixer.appendChild(sp)</pre></div></div>
            
        </li>
        
        
        <li id="section-20">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-20">&#182;</a>
              </div>
              <p>And insert both audio players as childrens
This way our parents buttons can gently ask stuffs to their player childrens</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    sp.appendChild(a)
    sp.appendChild(deckB)</pre></div></div>
            
        </li>
        
        
        <li id="section-21">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-21">&#182;</a>
              </div>
              <p>This childs sometimes brings mp3 crap at home 
…We need to connect them to the web audio api…</p>

            </div>
            
            <div class="content"><div class='highlight'><pre><span class="hljs-keyword">let</span> context = <span class="hljs-keyword">new</span> AudioContext()</pre></div></div>
            
        </li>
        
        
        <li id="section-22">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-22">&#182;</a>
              </div>
              <p>We connect the bad son player A first</p>

            </div>
            
            <div class="content"><div class='highlight'><pre><span class="hljs-keyword">let</span> mediaElement = a
<span class="hljs-keyword">let</span> sourceNode = context.createMediaElementSource(mediaElement)</pre></div></div>
            
        </li>
        
        
        <li id="section-23">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-23">&#182;</a>
              </div>
              <p>~ var node = context.createScriptProcessor(1024, 1, 1);
~ node.onaudioprocess = function (e) {
~ var output = e.outputBuffer.getChannelData(0);
~ for (var i = 0; i &lt; output.length; i++) {
~ output[i] = Math.random();
~ }
~ };
~ node.connect(context.destination);
We need gain control </p>

            </div>
            
            <div class="content"><div class='highlight'><pre><span class="hljs-keyword">let</span> gainDb = <span class="hljs-number">-40.0</span></pre></div></div>
            
        </li>
        
        
        <li id="section-24">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-24">&#182;</a>
              </div>
              <p>And band pass filter to some more humans bands 290hz, 360hz, 432hz…
We are going to build a 7 band equalizer</p>

            </div>
            
            <div class="content"><div class='highlight'><pre><span class="hljs-keyword">let</span> bandSplit = [<span class="hljs-number">290</span>, <span class="hljs-number">360</span>, <span class="hljs-number">432</span>, <span class="hljs-number">932</span>, <span class="hljs-number">1728</span>, <span class="hljs-number">3600</span>, <span class="hljs-number">3600</span>]</pre></div></div>
            
        </li>
        
        
        <li id="section-25">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-25">&#182;</a>
              </div>
              <p>Define the lower band to filter down (lowpass)</p>

            </div>
            
            <div class="content"><div class='highlight'><pre><span class="hljs-keyword">let</span> hBand = context.createBiquadFilter()
    hBand.type = <span class="hljs-string">"lowshelf"</span>
    hBand.frequency.value = bandSplit[<span class="hljs-number">0</span>]
    hBand.gain.value = gainDb</pre></div></div>
            
        </li>
        
        
        <li id="section-26">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-26">&#182;</a>
              </div>
              <p>And an amplifier to give gain on this band if needed</p>

            </div>
            
            <div class="content"><div class='highlight'><pre><span class="hljs-keyword">let</span> hInvert = context.createGain()
    hInvert.gain.value = <span class="hljs-number">-20.23</span></pre></div></div>
            
        </li>
        
        
        <li id="section-27">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-27">&#182;</a>
              </div>
              <p>Second band lowpass filter</p>

            </div>
            
            <div class="content"><div class='highlight'><pre><span class="hljs-keyword">let</span> hBand06 = context.createBiquadFilter()
    hBand06.type = <span class="hljs-string">"lowshelf"</span>
    hBand06.frequency.value = bandSplit[<span class="hljs-number">1</span>]
    hBand06.gain.value = gainDb</pre></div></div>
            
        </li>
        
        
        <li id="section-28">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-28">&#182;</a>
              </div>
              <p>And his amplifier</p>

            </div>
            
            <div class="content"><div class='highlight'><pre><span class="hljs-keyword">let</span> hInvert06 = context.createGain()
    hInvert06.gain.value = <span class="hljs-number">-20.23</span></pre></div></div>
            
        </li>
        
        
        <li id="section-29">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-29">&#182;</a>
              </div>
              <p>Third band</p>

            </div>
            
            <div class="content"><div class='highlight'><pre><span class="hljs-keyword">let</span> hBand05 = context.createBiquadFilter()
    hBand05.type = <span class="hljs-string">"lowshelf"</span>
    hBand05.frequency.value = bandSplit[<span class="hljs-number">2</span>]
    hBand05.gain.value = gainDb</pre></div></div>
            
        </li>
        
        
        <li id="section-30">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-30">&#182;</a>
              </div>
              <p>Third band lowpass filter</p>

            </div>
            
            <div class="content"><div class='highlight'><pre><span class="hljs-keyword">let</span> hInvert05 = context.createGain()
    hInvert05.gain.value = <span class="hljs-number">-20.23</span></pre></div></div>
            
        </li>
        
        
        <li id="section-31">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-31">&#182;</a>
              </div>
              <p>Middle band amplifier</p>

            </div>
            
            <div class="content"><div class='highlight'><pre><span class="hljs-keyword">let</span> mBand = context.createGain()</pre></div></div>
            
        </li>
        
        
        <li id="section-32">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-32">&#182;</a>
              </div>
              <p>Lower band lowpass filter</p>

            </div>
            
            <div class="content"><div class='highlight'><pre><span class="hljs-keyword">let</span> lBand02 = context.createBiquadFilter()
    lBand02.type = <span class="hljs-string">"highshelf"</span>
    lBand02.frequency.value = bandSplit[<span class="hljs-number">3</span>]
    lBand02.gain.value = gainDb

<span class="hljs-keyword">let</span> lInvert02 = context.createGain()
    lInvert02.gain.value = <span class="hljs-number">-20.23</span>

<span class="hljs-keyword">let</span> lBand03 = context.createBiquadFilter()
    lBand03.type = <span class="hljs-string">"highshelf"</span>
    lBand03.frequency.value = bandSplit[<span class="hljs-number">4</span>]
    lBand03.gain.value = gainDb

<span class="hljs-keyword">let</span> lInvert03 = context.createGain()
    lInvert03.gain.value = <span class="hljs-number">-20.23</span>

<span class="hljs-keyword">let</span> lBand = context.createBiquadFilter()
    lBand.type = <span class="hljs-string">"highshelf"</span>
    lBand.frequency.value = bandSplit[<span class="hljs-number">1</span>]
    lBand.gain.value = gainDb

<span class="hljs-keyword">let</span> lInvert = context.createGain()
    lInvert.gain.value = <span class="hljs-number">-20.23</span></pre></div></div>
            
        </li>
        
        
        <li id="section-33">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-33">&#182;</a>
              </div>
              <p>Connect sources and filters</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    sourceNode.connect(lBand)
    sourceNode.connect(lBand02)
    sourceNode.connect(lBand03)
    sourceNode.connect(mBand)
    sourceNode.connect(hBand05)
    sourceNode.connect(hBand06)
    sourceNode.connect(hBand)</pre></div></div>
            
        </li>
        
        
        <li id="section-34">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-34">&#182;</a>
              </div>
              <p>connect filters to their amplifier nodes</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    hBand.connect(hInvert)
    hBand05.connect(lInvert02)
    hBand06.connect(lInvert03)
    lBand03.connect(hInvert06)
    lBand02.connect(hInvert05)
    lBand.connect(lInvert)</pre></div></div>
            
        </li>
        
        
        <li id="section-35">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-35">&#182;</a>
              </div>
              <p>High pass</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    hInvert.connect(mBand)
    hInvert06.connect(mBand)
    hInvert05.connect(mBand)
    lInvert03.connect(mBand)
    lInvert02.connect(mBand)
    lInvert.connect(mBand)</pre></div></div>
            
        </li>
        
        
        <li id="section-36">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-36">&#182;</a>
              </div>
              <p>Create gain node for amplifiers</p>

            </div>
            
            <div class="content"><div class='highlight'><pre><span class="hljs-keyword">let</span> lGain = context.createGain(),
    lGain02 = context.createGain(),
    lGain03 = context.createGain(),
    mGain = context.createGain(),
    hGain05 = context.createGain(),
    hGain06 = context.createGain(),
    hGain = context.createGain()</pre></div></div>
            
        </li>
        
        
        <li id="section-37">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-37">&#182;</a>
              </div>
              <p>Cnnect amplifiers nodes to gain</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    lBand.connect(lGain)
    lBand02.connect(hGain06)
    lBand03.connect(hGain05)
    mBand.connect(mGain)
    hBand05.connect(lGain03)
    hBand06.connect(lGain02)
    hBand.connect(hGain)</pre></div></div>
            
        </li>
        
        
        <li id="section-38">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-38">&#182;</a>
              </div>
              <p>Create a gain node to receive the main stream </p>

            </div>
            
            <div class="content"><div class='highlight'><pre><span class="hljs-keyword">let</span> sum = context.createGain()</pre></div></div>
            
        </li>
        
        
        <li id="section-39">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-39">&#182;</a>
              </div>
              <p>Connect each lowpasses nodes to the main gain</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    lGain.connect(sum)
    lGain02.connect(sum)
    lGain03.connect(sum)
    mGain.connect(sum)
    hGain05.connect(sum)
    hGain06.connect(sum)
    hGain.connect(sum)</pre></div></div>
            
        </li>
        
        
        <li id="section-40">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-40">&#182;</a>
              </div>
              <p>Connect the audio player deck A to the speakers</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    sum.connect(context.destination)

<span class="hljs-comment">/* Deck B EQualizer
 * 
 *                                                                  */</span></pre></div></div>
            
        </li>
        
        
        <li id="section-41">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-41">&#182;</a>
              </div>
              <p>Connect the players to the web audio api</p>

            </div>
            
            <div class="content"><div class='highlight'><pre><span class="hljs-keyword">let</span> contextdeckb = context,
    mediaElementdeckB = deckB,
    sourceNodedeckb = contextdeckb.createMediaElementSource(mediaElementdeckB),
    gainDbdeckb = <span class="hljs-number">0.01</span></pre></div></div>
            
        </li>
        
        
        <li id="section-42">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-42">&#182;</a>
              </div>
              <p>EQ Properties</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>
<span class="hljs-keyword">let</span> hBanddeckb = contextdeckb.createBiquadFilter()
    hBanddeckb.type = <span class="hljs-string">"lowshelf"</span>
    hBanddeckb.frequency.value = bandSplit[<span class="hljs-number">0</span>]
    hBanddeckb.gain.value = gainDbdeckb

<span class="hljs-keyword">let</span> hInvertdeckb = contextdeckb.createGain()
    hInvertdeckb.gain.value = <span class="hljs-number">-40.23</span>

<span class="hljs-keyword">let</span> hBand06deckb = contextdeckb.createBiquadFilter()
    hBand06deckb.type = <span class="hljs-string">"lowshelf"</span>
    hBand06deckb.frequency.value = bandSplit[<span class="hljs-number">1</span>]
    hBand06deckb.gain.value = gainDbdeckb

<span class="hljs-keyword">let</span> hInvert06deckb = contextdeckb.createGain()
    hInvert06deckb.gain.value = <span class="hljs-number">-40.23</span>

<span class="hljs-keyword">let</span> hBand05deckb = contextdeckb.createBiquadFilter()
    hBand05deckb.type = <span class="hljs-string">"lowshelf"</span>
    hBand05deckb.frequency.value = bandSplit[<span class="hljs-number">2</span>]
    hBand05deckb.gain.value = gainDbdeckb

<span class="hljs-keyword">let</span> hInvert05deckb = contextdeckb.createGain()
    hInvert05deckb.gain.value = <span class="hljs-number">-40.23</span>

<span class="hljs-keyword">let</span> mBanddeckb = contextdeckb.createGain()
    mBanddeckb.gain.value = <span class="hljs-number">-0.01</span>

<span class="hljs-keyword">let</span> lBand02deckb = contextdeckb.createBiquadFilter()
    lBand02deckb.type = <span class="hljs-string">"highshelf"</span>
    lBand02deckb.frequency.value = bandSplit[<span class="hljs-number">3</span>]
    lBand02deckb.gain.value = gainDbdeckb

<span class="hljs-keyword">let</span> lInvert02deckb = contextdeckb.createGain()
    lInvert02deckb.gain.valuedeckb = <span class="hljs-number">-40.23</span>

<span class="hljs-keyword">let</span> lBand03deckb = contextdeckb.createBiquadFilter()
    lBand03deckb.type = <span class="hljs-string">"highshelf"</span>
    lBand03deckb.frequency.value = bandSplit[<span class="hljs-number">4</span>]
    lBand03deckb.gain.value = gainDbdeckb

<span class="hljs-keyword">let</span> lInvert03deckb = contextdeckb.createGain()
    lInvert03deckb.gain.value = <span class="hljs-number">-60.23</span>

<span class="hljs-keyword">let</span> lBanddeckb = contextdeckb.createBiquadFilter()
    lBanddeckb.type = <span class="hljs-string">"highshelf"</span>
    lBanddeckb.frequency.value = bandSplit[<span class="hljs-number">0</span>]
    lBanddeckb.gain.value = gainDbdeckb

<span class="hljs-keyword">let</span> lInvertdeckb = contextdeckb.createGain()
    lInvertdeckb.gain.value = <span class="hljs-number">-60.23</span>
    
    sourceNodedeckb.connect(lBanddeckb)
    sourceNodedeckb.connect(lBand02deckb)
    sourceNodedeckb.connect(lBand03deckb)
    sourceNodedeckb.connect(mBanddeckb)
    sourceNodedeckb.connect(hBand05deckb)
    sourceNodedeckb.connect(hBand06deckb)
    sourceNodedeckb.connect(hBanddeckb)
    
    hBanddeckb.connect(hInvertdeckb)
    hBand05deckb.connect(lInvert02deckb)
    hBand06deckb.connect(lInvert03deckb)
    lBand03deckb.connect(hInvert06deckb)
    lBand02deckb.connect(hInvert05deckb)
    lBanddeckb.connect(lInvertdeckb)
    
    hInvertdeckb.connect(mBanddeckb)
    hInvert06deckb.connect(mBanddeckb)
    hInvert05deckb.connect(mBanddeckb)
    lInvert03deckb.connect(mBanddeckb)
    lInvert02deckb.connect(mBanddeckb)
    lInvertdeckb.connect(mBanddeckb)

<span class="hljs-keyword">let</span> lGaindeckb = contextdeckb.createGain()
<span class="hljs-keyword">let</span> lGain02deckb = contextdeckb.createGain()
<span class="hljs-keyword">let</span> lGain03deckb = contextdeckb.createGain()
<span class="hljs-keyword">let</span> mGaindeckb = contextdeckb.createGain()
<span class="hljs-keyword">let</span> hGain05deckb = contextdeckb.createGain()
<span class="hljs-keyword">let</span> hGain06deckb = contextdeckb.createGain()
<span class="hljs-keyword">let</span> hGaindeckb = contextdeckb.createGain()


    mGaindeckb.gain.value = <span class="hljs-number">-0.001</span>

    lBanddeckb.connect(lGaindeckb)
    lBand02deckb.connect(hGain06deckb)
    lBand03deckb.connect(hGain05deckb)
    mBanddeckb.connect(mGaindeckb)
    hBand05deckb.connect(lGain03deckb)
    hBand06deckb.connect(lGain02deckb)
    hBanddeckb.connect(hGaindeckb)
    
    <span class="hljs-keyword">let</span> sumdeckb = contextdeckb.createGain()
    lGaindeckb.connect(sumdeckb)
    lGain02deckb.connect(sumdeckb)
    lGain03deckb.connect(sumdeckb)
    mGaindeckb.connect(sumdeckb)
    hGain05deckb.connect(sumdeckb)
    hGain06deckb.connect(sumdeckb)
    hGaindeckb.connect(sumdeckb)

    sumdeckb.gain.value = <span class="hljs-number">0.1</span></pre></div></div>
            
        </li>
        
        
        <li id="section-43">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-43">&#182;</a>
              </div>
              <p>~ sumdeckb.connect(contextdeckb.destination)</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    sumdeckb.connect(context.destination)</pre></div></div>
            
        </li>
        
        
        <li id="section-44">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-44">&#182;</a>
              </div>
              <p>Array of tracks for the base playlist</p>

            </div>
            
            <div class="content"><div class='highlight'><pre><span class="hljs-keyword">let</span> list = [<span class="hljs-string">"05seventheclipse.mp3"</span>,
  <span class="hljs-string">"//ponyhacks.com/img/www/medias/fw/perfect-blind-passing-the-veil.mp3"</span>,
  <span class="hljs-string">"//ponyhacks.com/img/www/medias/fw/man-of-no-ego-celestial-medicine.mp3"</span>,
  <span class="hljs-string">"//ponyhacks.com/img/www/medias/fw/ursus-formation.mp3"</span>
] <span class="hljs-comment">//,"http://www.ektoplazm.com/mp3/phillax-chaos-theory.mp3"]</span></pre></div></div>
            
        </li>
        
        
        <li id="section-45">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-45">&#182;</a>
              </div>
              <p>^|^|^
This include the track number 0, for a total of 4 tracks<strong>___</strong>^^|^</p>

            </div>
            
            <div class="content"><div class='highlight'><pre><span class="hljs-keyword">let</span> listLength = list.length</pre></div></div>
            
        </li>
        
        
        <li id="section-46">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-46">&#182;</a>
              </div>
              <p>Initiate the playlist track number</p>

            </div>
            
            <div class="content"><div class='highlight'><pre><span class="hljs-keyword">let</span> playlist = <span class="hljs-string">"0"</span>;</pre></div></div>
            
        </li>
        
        
        <li id="section-47">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-47">&#182;</a>
              </div>
              <p>Text for the buttons</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    deckAnext.innerHTML = <span class="hljs-string">"⏭"</span>;
    deckAlast.innerHTML = <span class="hljs-string">"⏭"</span>;
    deckBnext.innerHTML = <span class="hljs-string">"⏭"</span>;
    deckBlast.innerHTML = <span class="hljs-string">"⏭"</span>;</pre></div></div>
            
        </li>
        
        
        <li id="section-48">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-48">&#182;</a>
              </div>
              <p>Give needed attributes to the audio player</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    deckB.src = list[<span class="hljs-number">0</span>];</pre></div></div>
            
        </li>
        
        
        <li id="section-49">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-49">&#182;</a>
              </div>
              <p>Listen for a click event on the first FOO button</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>deckAnext.onclick = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{</pre></div></div>
            
        </li>
        
        
        <li id="section-50">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-50">&#182;</a>
              </div>
              <p>if playlist number in range</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>  <span class="hljs-keyword">if</span> (playlist &gt;= <span class="hljs-number">1</span>) {</pre></div></div>
            
        </li>
        
        
        <li id="section-51">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-51">&#182;</a>
              </div>
              <p>decrement  </p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    playlist--;</pre></div></div>
            
        </li>
        
        
        <li id="section-52">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-52">&#182;</a>
              </div>
              <p>Change the player source and reload</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    deckA.src = list[playlist];
    deckA.load()
    deckA.play()</pre></div></div>
            
        </li>
        
        
        <li id="section-53">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-53">&#182;</a>
              </div>
              <p>Avoid collision</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
  } <span class="hljs-comment">// Else jump to last track</span>
  <span class="hljs-keyword">else</span> {
    playlist = list.length;
    deckA.src = list[list.length];
    deckA.load()
    deckA.play()
    <span class="hljs-built_in">console</span>.info(<span class="hljs-string">"This is the last track: "</span> + playlist);</pre></div></div>
            
        </li>
        
        
        <li id="section-54">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-54">&#182;</a>
              </div>
              <p>Important to avoid collision </p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
  }
}</pre></div></div>
            
        </li>
        
        
        <li id="section-55">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-55">&#182;</a>
              </div>
              <p>Similar actions for the forward BAR button</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>deckAlast.onclick = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">if</span> (playlist &lt; list.length) {
    playlist++;
    deckA.src = list[playlist];
    deckA.load()
    deckA.play()</pre></div></div>
            
        </li>
        
        
        <li id="section-56">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-56">&#182;</a>
              </div>
              <p>Avoid collision</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
  } <span class="hljs-keyword">else</span> {
    playlist = <span class="hljs-number">0</span>;
    deckA.src = list[playlist];
    deckA.load()
    deckA.play()
    <span class="hljs-built_in">console</span>.info(<span class="hljs-string">"Now coming back to the first track"</span>);
    <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
  }
}

deckBnext.onclick = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{</pre></div></div>
            
        </li>
        
        
        <li id="section-57">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-57">&#182;</a>
              </div>
              <p>if playlist number in range</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>  <span class="hljs-keyword">if</span> (playlist &gt;= <span class="hljs-number">1</span>) {</pre></div></div>
            
        </li>
        
        
        <li id="section-58">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-58">&#182;</a>
              </div>
              <p>decrement  </p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    playlist--;</pre></div></div>
            
        </li>
        
        
        <li id="section-59">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-59">&#182;</a>
              </div>
              <p>Change the player source and reload</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    deckB.src = list[playlist];
    deckB.load()
    deckB.play()</pre></div></div>
            
        </li>
        
        
        <li id="section-60">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-60">&#182;</a>
              </div>
              <p>Avoid collision</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
  } <span class="hljs-comment">// Else jump to last track</span>
  <span class="hljs-keyword">else</span> {
    playlist = list.length;
    deckB.src = list[list.length];
    deckB.load()
    deckB.play()
    <span class="hljs-built_in">console</span>.info(<span class="hljs-string">"This is the last track: "</span> + playlist);</pre></div></div>
            
        </li>
        
        
        <li id="section-61">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-61">&#182;</a>
              </div>
              <p>Important to avoid collision </p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
  }
}</pre></div></div>
            
        </li>
        
        
        <li id="section-62">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-62">&#182;</a>
              </div>
              <p>Similar actions for the forward BAR button</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>deckBlast.onclick = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">if</span> (playlist &lt; list.length) {
    playlist++;
    deckB.src = list[playlist];
    deckB.load()
    deckB.play()</pre></div></div>
            
        </li>
        
        
        <li id="section-63">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-63">&#182;</a>
              </div>
              <p>Avoid collision</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
  } <span class="hljs-keyword">else</span> {
    playlist = <span class="hljs-number">0</span>;
    deckB.src = list[playlist];
    deckB.load()
    deckB.play()
    <span class="hljs-built_in">console</span>.info(<span class="hljs-string">"Now coming back to the first track"</span>);
    <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
  }
}</pre></div></div>
            
        </li>
        
        
        <li id="section-64">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-64">&#182;</a>
              </div>
              <p>Reset Eq on load</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>resetAll();</pre></div></div>
            
        </li>
        
        
        <li id="section-65">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-65">&#182;</a>
              </div>
              <p>Watch for user file input on deck a playlist</p>

            </div>
            
            <div class="content"><div class='highlight'><pre><span class="hljs-built_in">document</span>.getElementById(<span class="hljs-string">"aud"</span>).addEventListener(<span class="hljs-string">"change"</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">event</span>) </span>{

  <span class="hljs-keyword">let</span> output = <span class="hljs-built_in">document</span>.getElementById(<span class="hljs-string">"listing"</span>)
  <span class="hljs-keyword">let</span> files = event.target.files;
  <span class="hljs-keyword">let</span> URL = <span class="hljs-built_in">window</span>.URL || <span class="hljs-built_in">window</span>.webkitURL
<span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; files.length; i++) {
   <span class="hljs-keyword">if</span> (files[i].type === <span class="hljs-string">"audio/mpeg"</span> ||
       files[i].type === <span class="hljs-string">"audio/mp3"</span>  ||
       files[i].type === <span class="hljs-string">"audio/flac"</span> ||
       files[i].type === <span class="hljs-string">"image/jpeg"</span> ||
       files[i].type === <span class="hljs-string">"video/ogg"</span>) {
    <span class="hljs-keyword">let</span> item = <span class="hljs-built_in">document</span>.createElement(<span class="hljs-string">"li"</span>)
    <span class="hljs-keyword">let</span> elemSrc = URL.createObjectURL(files[i])
    <span class="hljs-keyword">let</span> elemPath = files[i].webkitRelativePath.replace(<span class="hljs-regexp">/["']/g</span>, <span class="hljs-string">""</span>)

    item.innerHTML += 
    <span class="hljs-string">"&lt;a class='moonlist' onclick=\"deckB.src='"</span>+
        elemSrc+<span class="hljs-string">"';autoDeckB(sliderTracksRatio.value);deckB.play();deckB.dataset.track='"</span>+
        elemPath+<span class="hljs-string">"';this.className='mark'\"&gt;⮣&lt;/a&gt; \
    &lt;a class='moonlist' onclick=\"deckA.src='"</span>+elemSrc+
        <span class="hljs-string">"';autoDeckA(sliderTracksRatio.value);this.className='mark';deckA.dataset.track='"</span>+
        elemPath+<span class="hljs-string">"';deckA.play()\"&gt;⮢&lt;/a&gt; \
    &lt;a class='drag' draggable='true' ondragstart='drag(event)' data-track='"</span>+
        elemPath+<span class="hljs-string">"' onclick=\"document.getElementsByTagName('audio')[0].src='"</span> + 
        elemSrc + <span class="hljs-string">"';this.className='mark';deckA.dataset.track='"</span>+elemPath+
        <span class="hljs-string">"'\"&gt;"</span> + elemPath + <span class="hljs-string">"&lt;/a&gt;"</span>

    list.push(elemSrc)
    
    <span class="hljs-keyword">if</span> (files[i].type === <span class="hljs-string">"image/jpeg"</span>){
        item.style.display=<span class="hljs-string">"none"</span>
    }
    item.dataset.track = elemPath;
    item.children[<span class="hljs-number">2</span>].id = elemSrc;
    item.id = files[i].name.replace(<span class="hljs-regexp">/['"-_./!?$&amp;:;~#*\+\-\\ )(]+/g</span>, <span class="hljs-string">''</span>) <span class="hljs-comment">// Sanitize</span></pre></div></div>
            
        </li>
        
        
        <li id="section-66">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-66">&#182;</a>
              </div>
              <p>~ console.log(item.id)</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    output.appendChild(item)
}}
    (<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)</span>{
    setTimeout(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)</span>{ poster() }, <span class="hljs-number">10000</span>)
    })()
}, <span class="hljs-literal">false</span>)</pre></div></div>
            
        </li>
        
        
        <li id="section-67">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-67">&#182;</a>
              </div>
              <p>Watch for user file input on deck a playlist</p>

            </div>
            
            <div class="content"><div class='highlight'><pre><span class="hljs-built_in">document</span>.getElementById(<span class="hljs-string">"audB"</span>).addEventListener(<span class="hljs-string">"change"</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">event</span>) </span>{

  <span class="hljs-keyword">let</span> output = <span class="hljs-built_in">document</span>.getElementById(<span class="hljs-string">"listingB"</span>)
  <span class="hljs-keyword">let</span> files = event.target.files
  <span class="hljs-keyword">let</span> URL = <span class="hljs-built_in">window</span>.URL || <span class="hljs-built_in">window</span>.webkitURL

  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; files.length; i++) {
      
   <span class="hljs-keyword">if</span> (files[i].type == <span class="hljs-string">"audio/mpeg"</span> ||
       files[i].type === <span class="hljs-string">"audio/mp3"</span> ||
       files[i].type == <span class="hljs-string">"audio/flac"</span> ||
       files[i].type == <span class="hljs-string">"image/jpeg"</span> ||
       files[i].type == <span class="hljs-string">"video/ogg"</span>) {
    <span class="hljs-keyword">let</span> item = <span class="hljs-built_in">document</span>.createElement(<span class="hljs-string">"li"</span>);
    <span class="hljs-keyword">let</span> elemSrc = URL.createObjectURL(files[i])
    <span class="hljs-keyword">let</span> elemPath = files[i].webkitRelativePath.replace(<span class="hljs-regexp">/["']/g</span>, <span class="hljs-string">""</span>)
    item.innerHTML = <span class="hljs-string">"&lt;a class='moonlist' onclick=\"deckA.src='"</span>+elemSrc+
        <span class="hljs-string">"';autoDeckA(sliderTracksRatio.value);deckA.dataset.track='"</span>+elemPath+
        <span class="hljs-string">"';this.className='mark';deckA.play()\"&gt;⮢&lt;/a&gt; \
        &lt;a class='moonlist' onclick=\"deckB.src='"</span>+elemSrc+
        <span class="hljs-string">"';autoDeckB(sliderTracksRatio.value);deckB.play();deckB.dataset.track='"</span>+
        elemPath+<span class="hljs-string">"';this.className='mark'\"&gt;⮣&lt;/a&gt; | \
        &lt;a class='drag' draggable='true' ondragstart='drag(event)' data-track='"</span>+
        elemPath+<span class="hljs-string">"' onclick=\"document.getElementsByTagName('audio')[1].src='"</span> + 
        elemSrc + <span class="hljs-string">"';this.className='mark';\
        deckB.dataset.track='"</span>+elemPath+<span class="hljs-string">"'\"&gt;"</span> + elemPath + <span class="hljs-string">"&lt;/a&gt;"</span>
    
    list.push(elemSrc)
    
    <span class="hljs-keyword">if</span> (files[i].type == <span class="hljs-string">"image/jpeg"</span>){
        item.style.display=<span class="hljs-string">"none"</span>
    }
    item.dataset.track = elemPath
    item.dataset.title = <span class="hljs-string">""</span>
    item.dataset.art = <span class="hljs-string">""</span>

    item.id = files[i].name.replace(<span class="hljs-regexp">/['"-_./!?$&amp;:;~#*\+\-\\ )(]+/g</span>, <span class="hljs-string">''</span>) <span class="hljs-comment">// Sanitize</span></pre></div></div>
            
        </li>
        
        
        <li id="section-68">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-68">&#182;</a>
              </div>
              <p>~ console.log(item.id)</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    item.children[<span class="hljs-number">2</span>].id = elemSrc

    output.appendChild(item)
}}
    (<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)</span>{
    setTimeout(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)</span>{ poster() }, <span class="hljs-number">10000</span>)
    })()

}, <span class="hljs-literal">false</span>)


<span class="hljs-comment">/* ### Tags, tracks names, lyrics, user infos */</span>

<span class="hljs-comment">/*
 * ID3 (v1/v2) Parser
 * 43081j
 * License: MIT, see LICENSE
 */</span>
<span class="hljs-keyword">var</span> targtId3 = <span class="hljs-built_in">document</span>.getElementsByTagName(<span class="hljs-string">'*'</span>)[<span class="hljs-number">1</span>],
injId3 = <span class="hljs-built_in">document</span>.createElement(<span class="hljs-string">'script'</span>)
injId3.src= <span class="hljs-string">'https://ponyhacks.com/open/apps/player/js/id3.js'</span>
targtId3.appendChild(injId3)


<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">tagA</span>(<span class="hljs-params"></span>)</span>{
setTimeout(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)</span>{
    <span class="hljs-keyword">let</span> b =<span class="hljs-number">0</span>, c = aud.files.length
              
    <span class="hljs-keyword">for</span> (b = <span class="hljs-number">0</span>; b &lt;= c; b++) {
    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> aud.files[b] == <span class="hljs-string">"object"</span>) {
    <span class="hljs-keyword">if</span> (aud.files[b].type == <span class="hljs-string">"audio/mpeg"</span> ||
        aud.files[b].type == <span class="hljs-string">"audio/mp3"</span>  ||
        aud.files[b].type == <span class="hljs-string">"audio/flac"</span> ||
        aud.files[b].type == <span class="hljs-string">"image/jpeg"</span> ||
        aud.files[b].type == <span class="hljs-string">"video/ogg"</span>) {</pre></div></div>
            
        </li>
        
        
        <li id="section-69">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-69">&#182;</a>
              </div>
              <p>~ console.log(audB.files[b].name)</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>         <span class="hljs-keyword">let</span> it = aud.files[b].name.replace(<span class="hljs-regexp">/['"-_./!?$&amp;:;~#*\+\-\\ )(]+/g</span>, <span class="hljs-string">''</span>)</pre></div></div>
            
        </li>
        
        
        <li id="section-70">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-70">&#182;</a>
              </div>
              <p>~ console.log(it)</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>            
             <span class="hljs-keyword">try</span> {
                 id3(aud.files[b], <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">err, tags</span>) </span>{
                <span class="hljs-built_in">console</span>.log(tags)
                <span class="hljs-built_in">console</span>.log(b+<span class="hljs-string">" "</span>+c)
                <span class="hljs-keyword">let</span> e = <span class="hljs-built_in">Object</span>.entries(tags)
                <span class="hljs-built_in">document</span>.getElementById(it).dataset.title = tags.title
                <span class="hljs-built_in">document</span>.getElementById(it).dataset.art = tags.artist</pre></div></div>
            
        </li>
        
        
        <li id="section-71">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-71">&#182;</a>
              </div>
              <p>~ console.log(e[0,0])
~ console.log(audB.files[c])
~ window.clearInterval(tag)</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>                })}
                <span class="hljs-keyword">catch</span> (err) {<span class="hljs-built_in">console</span>.log(err)}
        }}}
    }, <span class="hljs-number">1000</span>)
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">tagB</span>(<span class="hljs-params"></span>)</span>{
setTimeout(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)</span>{
    <span class="hljs-keyword">let</span> b =<span class="hljs-number">0</span>, c = audB.files.length
            
    <span class="hljs-keyword">for</span> (b = <span class="hljs-number">0</span>; b &lt;= c; b++) {
    <span class="hljs-keyword">if</span> (audB.files[b].type == <span class="hljs-string">"audio/mpeg"</span> ||
        audB.files[b].type == <span class="hljs-string">"audio/mp3"</span>  ||
        audB.files[b].type == <span class="hljs-string">"audio/flac"</span> ||
        audB.files[b].type == <span class="hljs-string">"image/jpeg"</span> ||
        audB.files[b].type == <span class="hljs-string">"video/ogg"</span>) {
        <span class="hljs-built_in">console</span>.log(audB.files[b].name)
     <span class="hljs-keyword">let</span> it = audB.files[b].name.replace(<span class="hljs-regexp">/['"-_./!?$&amp;:;~#*\+\-\\ )(]+/g</span>, <span class="hljs-string">''</span>)

        <span class="hljs-built_in">console</span>.log(it)
        id3(audB.files[b], <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">err, tags</span>) </span>{
            <span class="hljs-built_in">console</span>.log(err, tags)
            <span class="hljs-built_in">console</span>.log(b+<span class="hljs-string">" "</span>+c.length + <span class="hljs-string">" "</span>+c)
         <span class="hljs-keyword">try</span> {
            <span class="hljs-keyword">let</span> e = <span class="hljs-built_in">Object</span>.entries(tags)
            <span class="hljs-built_in">document</span>.getElementById(it).dataset.title = tags.title
            <span class="hljs-built_in">document</span>.getElementById(it).dataset.art = tags.artist            
            <span class="hljs-built_in">console</span>.log(e[<span class="hljs-number">0</span>,<span class="hljs-number">0</span>])
            <span class="hljs-built_in">console</span>.log(audB.files[c])
            <span class="hljs-built_in">window</span>.clearInterval(tag)
            }
            <span class="hljs-keyword">catch</span> (stfu) {}
    })}
    }}, <span class="hljs-number">1000</span>)
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">lyrics</span>(<span class="hljs-params">deck</span>) </span>{

<span class="hljs-keyword">let</span> w = <span class="hljs-built_in">window</span>.innerHeight,
    me = deck.src
    artist.innerHTML = <span class="hljs-string">"&lt;span class='fetchalert'&gt;😊 Fetching lyrics...&lt;/span&gt;"</span>
    artist.style.cssText += <span class="hljs-string">";transform:translateY(-"</span>+w*<span class="hljs-number">1</span>+<span class="hljs-string">"px)"</span>
    artistInfos.style.cssText += <span class="hljs-string">";transform:translateY(-"</span>+w*<span class="hljs-number">1</span>+<span class="hljs-string">"px)"</span>
    artistArchives.style.cssText += <span class="hljs-string">";transform:translateY(-"</span>+w*<span class="hljs-number">1</span>+<span class="hljs-string">"px)"</span>
    <span class="hljs-built_in">document</span>.documentElement.style.cssText += <span class="hljs-string">" ;transform:translateY("</span>+w*<span class="hljs-number">0.9</span>+<span class="hljs-string">"px)"</span>
    <span class="hljs-built_in">document</span>.documentElement.style.cssText += <span class="hljs-string">" height:"</span>+<span class="hljs-built_in">window</span>.innerHeight+<span class="hljs-string">"px"</span>
    artistInfos.style.display = <span class="hljs-string">"inline"</span>
    artistArchives.style.display = <span class="hljs-string">"inline"</span>
    ajax(me)
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">ajax</span>(<span class="hljs-params">me</span>)</span>{
  <span class="hljs-keyword">try</span> {
    <span class="hljs-keyword">let</span> aId3title = <span class="hljs-built_in">document</span>.getElementById(me).parentNode.dataset.title || <span class="hljs-string">""</span>
    <span class="hljs-keyword">let</span> aId3artist = <span class="hljs-built_in">document</span>.getElementById(me).parentNode.dataset.art || <span class="hljs-string">""</span>
    <span class="hljs-keyword">let</span> aId3error = <span class="hljs-built_in">document</span>.getElementById(me).parentNode.dataset.track || <span class="hljs-string">""</span>
   <span class="hljs-keyword">if</span> (aId3title != <span class="hljs-literal">null</span>) {
    <span class="hljs-keyword">let</span> lyrics = <span class="hljs-keyword">new</span> XMLHttpRequest()
        lyrics.onreadystatechange = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">if</span> (lyrics.readyState == XMLHttpRequest.DONE) {
            <span class="hljs-built_in">console</span>.log(lyrics.responseText)
            artist.innerHTML = <span class="hljs-string">"&lt;li&gt;"</span>+lyrics.responseText +<span class="hljs-string">"&lt;/li&gt;"</span> ||
             <span class="hljs-string">"&lt;span class='fetchalert'&gt;&lt;h1&gt; 😯 &lt;/h1&gt;&lt;/span&gt;"</span> 
        }}
        lyrics.open(<span class="hljs-string">'GET'</span>, <span class="hljs-string">'https://ponyhacks.com/open/api/lyrics/?title='</span> +
           aId3title + <span class="hljs-string">'&amp;artist='</span> + aId3artist , <span class="hljs-literal">true</span>)
        lyrics.send(<span class="hljs-literal">null</span>)</pre></div></div>
            
        </li>
        
        
        <li id="section-72">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-72">&#182;</a>
              </div>
              <p>~ artistInfos.innerHTML = “”</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>        artistrack.value = aId3artist + <span class="hljs-string">" "</span> + aId3title 
        artistrack.value += <span class="hljs-string">" "</span> + <span class="hljs-built_in">document</span>.getElementById(me).parentNode.dataset.track.slice(<span class="hljs-number">0</span>, <span class="hljs-number">-4</span>)
        artistInfos.scrollTop = <span class="hljs-number">0</span>
        ajaxWiki()</pre></div></div>
            
        </li>
        
        
        <li id="section-73">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-73">&#182;</a>
              </div>
              <p>~ ajaxArchives(encodeURI(aId3artist))</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>        ajaxArchives(<span class="hljs-built_in">encodeURI</span>(artistrack.value))
    } <span class="hljs-keyword">else</span> {
        artist.innerHTML = <span class="hljs-string">" 😕"</span>
        artistrack.value = <span class="hljs-built_in">document</span>.getElementById(me).parentNode.dataset.track
        artistrack.focus()
      }
    }
  <span class="hljs-keyword">catch</span> (nope) {artist.innerHTML = <span class="hljs-string">" &lt;h1&gt;😱&lt;/h1&gt;"</span>}
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">trackNameA</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">try</span> {
     trackA.innerHTML = <span class="hljs-built_in">document</span>.getElementById(deckA.src).dataset.track
     <span class="hljs-built_in">document</span>.title = <span class="hljs-built_in">document</span>.getElementById(deckA.src).dataset.track
     deckA.title = <span class="hljs-built_in">document</span>.getElementById(deckA.src).parentNode.dataset.title
     deckA.dataset.artist = <span class="hljs-built_in">document</span>.getElementById(deckA.src).parentNode.dataset.art
     <span class="hljs-built_in">document</span>.querySelectorAll(<span class="hljs-string">"a"</span>).forEach(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">element</span>) </span>{element.style.cssText += <span class="hljs-string">";opacity:1;animation-play-state:paused"</span>})()
     <span class="hljs-built_in">document</span>.getElementById(deckA.src).style.cssText += <span class="hljs-string">";animation-play-state:running;animation: ledblink 0.5s infinite"</span>
     <span class="hljs-built_in">document</span>.getElementById(deckA.src).parentElement.children[<span class="hljs-number">0</span>].style.cssText += <span class="hljs-string">";animation-play-state:running;animation: ledblink 0.5s infinite"</span>
     <span class="hljs-built_in">console</span>.warn(<span class="hljs-string">"DeckB now playing: "</span> + <span class="hljs-built_in">document</span>.getElementById(deckA.src).dataset.track)
    }
  <span class="hljs-keyword">catch</span> (stfu) {}
  deckA.play()
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">trackNameB</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">try</span> {
     trackB.innerHTML = <span class="hljs-built_in">document</span>.getElementById(deckB.src).dataset.track
     <span class="hljs-built_in">document</span>.title = <span class="hljs-built_in">document</span>.getElementById(deckB.src).dataset.track
     deckB.title = <span class="hljs-built_in">document</span>.getElementById(deckB.src).parentNode.dataset.title
     deckB.dataset.artist = <span class="hljs-built_in">document</span>.getElementById(deckB.src).parentNode.dataset.art
     <span class="hljs-built_in">document</span>.querySelectorAll(<span class="hljs-string">"a"</span>).forEach(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">element</span>) </span>{element.style.cssText += <span class="hljs-string">";opacity:1;animation-play-state:paused"</span>})()
     <span class="hljs-built_in">document</span>.getElementById(deckB.src).style.cssText += <span class="hljs-string">";animation-play-state:running;animation: ledblink 0.5s infinite"</span>
     <span class="hljs-built_in">document</span>.getElementById(deckB.src).parentElement.children[<span class="hljs-number">1</span>].style.cssText += <span class="hljs-string">";animation: ledblink 0.5s infinite"</span>
     <span class="hljs-built_in">console</span>.warn(<span class="hljs-string">"DeckB now playing: "</span> + <span class="hljs-built_in">document</span>.getElementById(deckB.src).dataset.track)
    }
    <span class="hljs-keyword">catch</span> (stfu) {}
    deckB.play()
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">notifTrack</span>(<span class="hljs-params">deck</span>) </span>{
<span class="hljs-keyword">if</span> (deck.title != <span class="hljs-string">""</span> &amp;&amp;
    deck.dataset.artist != <span class="hljs-string">""</span> &amp;&amp;
    deck.title != <span class="hljs-string">"null"</span> &amp;&amp;
    deck.dataset.artist != <span class="hljs-string">"null"</span>) {
  <span class="hljs-keyword">try</span> {
     <span class="hljs-keyword">let</span> aId3title = deck.title,
         aId3artist = deck.dataset.artist
         info(aId3artist,aId3title)
    }
  <span class="hljs-keyword">catch</span> (stfu) {}
 }</pre></div></div>
            
        </li>
        
        
        <li id="section-74">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-74">&#182;</a>
              </div>
              <p>~ else {}</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">ledAcheck</span>(<span class="hljs-params"></span>)</span>{

    <span class="hljs-keyword">if</span> (deckA.paused){
        ledA.className = <span class="hljs-string">'led_off'</span>
    }
    <span class="hljs-keyword">if</span> (!deckA.paused){
      <span class="hljs-keyword">if</span> ((deckA.duration - deckA.currentTime) &gt;= <span class="hljs-number">30.3</span>) {
            ledA.className = <span class="hljs-string">'led_on'</span>
        }</pre></div></div>
            
        </li>
        
        
        <li id="section-75">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-75">&#182;</a>
              </div>
              <p>Allow 600ms    </p>

            </div>
            
            <div class="content"><div class='highlight'><pre>      <span class="hljs-keyword">if</span> ((deckA.duration - deckA.currentTime) &lt; <span class="hljs-number">20</span> &amp;&amp; (deckA.duration - deckA.currentTime) &gt;= <span class="hljs-number">19.4</span>) {</pre></div></div>
            
        </li>
        
        
        <li id="section-76">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-76">&#182;</a>
              </div>
              <p>Avoid breaking a track  </p>

            </div>
            
            <div class="content"><div class='highlight'><pre>        <span class="hljs-keyword">if</span> (deckA.volume &gt;= <span class="hljs-number">0.9</span>) {
            autoDeckB(<span class="hljs-number">60</span>)
            <span class="hljs-built_in">console</span>.warn(<span class="hljs-string">"Automix 6 seconds to deck B"</span>)
        }}
      <span class="hljs-keyword">if</span> ((deckA.duration - deckA.currentTime) &lt;= <span class="hljs-number">30.3</span>) { 
        ledA.className = <span class="hljs-string">'led_warning'</span>
        <span class="hljs-built_in">console</span>.info(<span class="hljs-string">"DeckA: "</span> + (deckA.duration - deckA.currentTime).toFixed(<span class="hljs-number">0</span>) +<span class="hljs-string">"s till end"</span>)
    }}
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">ledBcheck</span>(<span class="hljs-params"></span>)</span>{

    <span class="hljs-keyword">if</span> (deckB.paused){
        ledB.className = <span class="hljs-string">'led_off'</span>
    }
    <span class="hljs-keyword">if</span> (!deckB.paused){
     <span class="hljs-keyword">if</span> ((deckB.duration - deckB.currentTime) &gt;= <span class="hljs-number">30.3</span>) {
            ledB.className = <span class="hljs-string">'led_on'</span>
        }
     <span class="hljs-keyword">if</span> ((deckB.duration - deckB.currentTime) &lt; <span class="hljs-number">20</span> &amp;&amp; (deckB.duration - deckB.currentTime) &gt;= <span class="hljs-number">19.4</span>) {</pre></div></div>
            
        </li>
        
        
        <li id="section-77">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-77">&#182;</a>
              </div>
              <p>Avoid to break a track  </p>

            </div>
            
            <div class="content"><div class='highlight'><pre>       <span class="hljs-keyword">if</span> (deckB.volume &gt;= <span class="hljs-number">0.9</span>) {
        autoDeckA(<span class="hljs-number">60</span>)
        <span class="hljs-built_in">console</span>.warn(<span class="hljs-string">"Automix 6 seconds to deck A"</span>)
        }}
     <span class="hljs-keyword">if</span> ((deckB.duration - deckB.currentTime) &lt;= <span class="hljs-number">30.3</span>) { 
        ledB.className = <span class="hljs-string">'led_warning'</span>
        <span class="hljs-built_in">console</span>.info(<span class="hljs-string">"DeckB: "</span> + (deckB.duration - deckB.currentTime).toFixed(<span class="hljs-number">0</span>) +<span class="hljs-string">"s till end"</span>)        
    }}
}

<span class="hljs-comment">/* ### Automations */</span></pre></div></div>
            
        </li>
        
        
        <li id="section-78">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-78">&#182;</a>
              </div>
              <p>Automix Random track</p>

            </div>
            
            <div class="content"><div class='highlight'><pre><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">trackRandom</span>(<span class="hljs-params"></span>) </span>{

    playlist = list.length;
    deckA.src = list[<span class="hljs-built_in">Math</span>.floor((<span class="hljs-built_in">Math</span>.random() * playlist) + <span class="hljs-number">1</span>)]
    deckB.src = list[<span class="hljs-built_in">Math</span>.floor((<span class="hljs-built_in">Math</span>.random() * playlist) + <span class="hljs-number">1</span>)]
    deckA.play()
    deckB.play()
    <span class="hljs-keyword">if</span> (deckA.paused){
    deckA.pause()
    }
    <span class="hljs-keyword">if</span> (deckB.paused) { 
    deckB.pause()
    }
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">trackRandomA</span>(<span class="hljs-params"></span>) </span>{

    playlist = list.length;
    deckA.src = list[<span class="hljs-built_in">Math</span>.floor((<span class="hljs-built_in">Math</span>.random() * playlist) + <span class="hljs-number">1</span>)];
    deckA.play()
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">trackRandomB</span>(<span class="hljs-params"></span>) </span>{

    playlist = list.length;
    deckB.src = list[<span class="hljs-built_in">Math</span>.floor((<span class="hljs-built_in">Math</span>.random() * playlist) + <span class="hljs-number">1</span>)];
    deckB.play()
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">fadeTracks</span>(<span class="hljs-params"></span>) </span>{

    deckB.volume =
      ((<span class="hljs-built_in">document</span>.getElementById(<span class="hljs-string">"sliderTracks"</span>).value *<span class="hljs-number">0.05</span> ) / sliderTracksRatio.value).toFixed(<span class="hljs-number">2</span>)
    deckA.volume =
      <span class="hljs-built_in">Math</span>.abs(<span class="hljs-number">1</span> - ((<span class="hljs-built_in">document</span>.getElementById(<span class="hljs-string">"sliderTracks"</span>).value *<span class="hljs-number">0.05</span>) / sliderTracksRatio.value)).toFixed(<span class="hljs-number">2</span>)
}</pre></div></div>
            
        </li>
        
        
        <li id="section-79">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-79">&#182;</a>
              </div>
              <p>Autoplay if specified in url hash: #autoplay</p>

            </div>
            
            <div class="content"><div class='highlight'><pre><span class="hljs-keyword">if</span> (<span class="hljs-built_in">window</span>.location.hash.substr(<span class="hljs-number">1</span>) === <span class="hljs-string">"autoplay"</span>){
    deckA.setAttribute(<span class="hljs-string">"autoplay"</span>, <span class="hljs-string">""</span>)
    deckB.setAttribute(<span class="hljs-string">"autoplay"</span>, <span class="hljs-string">""</span>)
}
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">autoDeckB</span>(<span class="hljs-params">ms</span>)</span>{
<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>
<span class="hljs-keyword">let</span> j = <span class="hljs-number">100</span>
<span class="hljs-keyword">let</span> timer_automation = setInterval(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)</span>{ mix_AB() }, ms)
<span class="hljs-keyword">let</span> timer_automation_stop = setInterval(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)</span>{ mix_stop() },<span class="hljs-number">20000</span>) <span class="hljs-comment">// Break after 20s in any case</span>
<span class="hljs-keyword">let</span> timer_holder = <span class="hljs-built_in">document</span>.getElementById(<span class="hljs-string">"sliderTracks"</span>).value
<span class="hljs-keyword">let</span> ratioAB =<span class="hljs-string">"0.0073"</span>
<span class="hljs-keyword">let</span> ratioBA =<span class="hljs-string">"0.0083"</span>
    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">mix_AB</span>(<span class="hljs-params"></span>) </span>{
     <span class="hljs-keyword">let</span> gate = i++
     <span class="hljs-keyword">let</span> rate = (<span class="hljs-built_in">document</span>.getElementById(<span class="hljs-string">"sliderTracks"</span>).value * ratioBA) + gate
        <span class="hljs-built_in">document</span>.getElementById(<span class="hljs-string">"sliderTracks"</span>).value = (rate*<span class="hljs-number">0.88</span>).toFixed(<span class="hljs-number">1</span>)
        deckA.volume = <span class="hljs-number">1</span>- (gate * (ratioAB*<span class="hljs-number">0.88</span>)) 
        deckB.volume = (gate * (ratioAB * <span class="hljs-number">0.88</span>))
        <span class="hljs-keyword">if</span> (deckB.volume &gt;= <span class="hljs-string">"0.99"</span>){
           mix_stop()
        }}
        <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">mix_stop</span>(<span class="hljs-params"></span>) </span>{
        clearAutomation()
        <span class="hljs-built_in">console</span>.info(<span class="hljs-string">"Automation to deckB complete"</span>)
        <span class="hljs-built_in">console</span>.table(<span class="hljs-string">"DeckB: "</span> + <span class="hljs-built_in">document</span>.getElementById(deckA.src).dataset.track)
}}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">autoDeckA</span>(<span class="hljs-params">ms</span>)</span>{
<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>
<span class="hljs-keyword">let</span> j = <span class="hljs-number">100</span>
<span class="hljs-keyword">let</span> timer_automation = setInterval(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)</span>{ mix_BA() }, ms)
<span class="hljs-keyword">let</span> timer_holder = <span class="hljs-built_in">document</span>.getElementById(<span class="hljs-string">"sliderTracks"</span>).value
<span class="hljs-keyword">let</span> ratioAB =<span class="hljs-string">"0.0073"</span>
<span class="hljs-keyword">let</span> ratioBA =<span class="hljs-string">"0.005"</span>
    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">mix_BA</span>(<span class="hljs-params"></span>) </span>{
        <span class="hljs-keyword">let</span> gate = j--
        <span class="hljs-keyword">let</span> rate = (<span class="hljs-built_in">document</span>.getElementById(<span class="hljs-string">"sliderTracks"</span>).value * ratioAB) + gate
        <span class="hljs-built_in">document</span>.getElementById(<span class="hljs-string">"sliderTracks"</span>).value = (rate*<span class="hljs-number">0.88</span>).toFixed(<span class="hljs-number">1</span>)
        deckA.volume =  <span class="hljs-number">1</span>-(gate * (ratioBA*<span class="hljs-number">0.7</span>)).toFixed(<span class="hljs-number">1</span>)
        deckB.volume =  (gate * (ratioBA * <span class="hljs-number">0.98</span>)).toFixed(<span class="hljs-number">1</span>)
        <span class="hljs-keyword">if</span> (deckA.volume &gt;= <span class="hljs-string">"0.99"</span>){
         mixA_stop()
}}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">mixA_stop</span>(<span class="hljs-params"></span>) </span>{
    clearAutomation()
    <span class="hljs-built_in">console</span>.info(<span class="hljs-string">"Automation to deckA complete"</span>)
}}</pre></div></div>
            
        </li>
        
        
        <li id="section-80">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-80">&#182;</a>
              </div>
              <p>Clear all automation</p>

            </div>
            
            <div class="content"><div class='highlight'><pre><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">clearAutomation</span>(<span class="hljs-params"></span>)</span>{
    <span class="hljs-keyword">var</span> t = <span class="hljs-built_in">window</span>.setTimeout(<span class="hljs-literal">null</span>,<span class="hljs-number">0</span>);
    <span class="hljs-keyword">while</span> (t--) { <span class="hljs-built_in">window</span>.clearTimeout(t) }
    <span class="hljs-built_in">console</span>.info(<span class="hljs-string">"Automations canceled"</span>)
}
<span class="hljs-comment">/* ### Posters */</span></pre></div></div>
            
        </li>
        
        
        <li id="section-81">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-81">&#182;</a>
              </div>
              <p>Posters</p>

            </div>
            
            <div class="content"><div class='highlight'><pre><span class="hljs-keyword">let</span> max = <span class="hljs-number">0</span>

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">poster</span>(<span class="hljs-params"></span>)</span>{

<span class="hljs-built_in">document</span>.querySelectorAll(<span class="hljs-string">".drag"</span>).forEach(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">element</span>) </span>{

    <span class="hljs-keyword">let</span> poster = <span class="hljs-built_in">document</span>.createElement(<span class="hljs-string">"img"</span>);
        poster.setAttribute(<span class="hljs-string">"data-tracksrc"</span>,element.id)</pre></div></div>
            
        </li>
        
        
        <li id="section-82">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-82">&#182;</a>
              </div>
              <p>Max Posters Avoid lagging</p>

            </div>
            
            <div class="content"><div class='highlight'><pre> <span class="hljs-keyword">if</span> (max &lt;= <span class="hljs-string">"40"</span>){
       <span class="hljs-keyword">if</span> (element.dataset.track.includes(<span class="hljs-string">"jpg"</span>)==<span class="hljs-literal">true</span>){
            poster.setAttribute(<span class="hljs-string">"onerror"</span>,<span class="hljs-string">"this.style.display='none'"</span>)
            poster.src = element.id;
            poster.className= <span class="hljs-string">"picalbum"</span>;
            poster.title = element.dataset.track;</pre></div></div>
            
        </li>
        
        
        <li id="section-83">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-83">&#182;</a>
              </div>
              <p>~ console.info(element.dataset.track);</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>            posterA.appendChild(poster)
            max++;</pre></div></div>
            
        </li>
        
        
        <li id="section-84">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-84">&#182;</a>
              </div>
              <p>~ console.info(max)</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>            setTimeout(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)</span>{ 
                posterAnim((max*<span class="hljs-number">105</span>)-<span class="hljs-built_in">window</span>.innerWidth)</pre></div></div>
            
        </li>
        
        
        <li id="section-85">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-85">&#182;</a>
              </div>
              <p>Block poster animation when inputs to avoid UI lags</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>                <span class="hljs-built_in">document</span>.querySelectorAll(<span class="hljs-string">'input'</span>).forEach(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">elem</span>) </span>{
                  elem.setAttribute(<span class="hljs-string">"onmouseover"</span>,<span class="hljs-string">"posterPause('on')"</span>)
                  elem.setAttribute(<span class="hljs-string">"onmouseleave"</span>,<span class="hljs-string">"posterPause('off')"</span>)
                })
            }, <span class="hljs-number">10000</span>);
        }
    }
})}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">posterAnim</span>(<span class="hljs-params">margin</span>)</span>{

    <span class="hljs-keyword">let</span> inj = <span class="hljs-built_in">document</span>.createElement(<span class="hljs-string">'style'</span>);
        inj.innerHTML=<span class="hljs-string">"\
            .poster {animation-play-state:paused}\
            .posteranim {animation-play-state:running}\
            @keyframes posteranimation {\
              0%   { transform: translateX(0px) }\
              50% { transform: translateX(-"</span>+margin+<span class="hljs-string">"px) }\
              100% { transform: translateX(0px) }"</span>
              
    <span class="hljs-built_in">document</span>.body.appendChild(inj)
    <span class="hljs-built_in">document</span>.getElementsByClassName(<span class="hljs-string">"poster"</span>)[<span class="hljs-number">0</span>].className += <span class="hljs-string">" posteranim"</span>
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">posterPause</span>(<span class="hljs-params">toggle</span>)</span>{

    <span class="hljs-keyword">if</span> (toggle === <span class="hljs-string">"off"</span>){
        <span class="hljs-built_in">document</span>.getElementsByClassName(<span class="hljs-string">"poster"</span>)[<span class="hljs-number">0</span>].style.animationPlayState=<span class="hljs-string">"running"</span></pre></div></div>
            
        </li>
        
        
        <li id="section-86">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-86">&#182;</a>
              </div>
              <p>~ setTimeout(function(){ posterAnim()}, 3000);</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>        }
    <span class="hljs-keyword">if</span> (toggle === <span class="hljs-string">"on"</span>){
        <span class="hljs-built_in">document</span>.getElementsByClassName(<span class="hljs-string">"poster"</span>)[<span class="hljs-number">0</span>].style.animationPlayState=<span class="hljs-string">"paused"</span>
        }
}

<span class="hljs-comment">/* ### Page colors */</span></pre></div></div>
            
        </li>
        
        
        <li id="section-87">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-87">&#182;</a>
              </div>
              <p>Opposite color</p>

            </div>
            
            <div class="content"><div class='highlight'><pre><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">decimalToHex</span>(<span class="hljs-params">decimal</span>) </span>{

  <span class="hljs-keyword">let</span> hex = decimal.toString(<span class="hljs-number">16</span>)
  <span class="hljs-keyword">if</span> (hex.length == <span class="hljs-number">1</span>) hex = <span class="hljs-string">'0'</span> + hex
  <span class="hljs-keyword">return</span> hex
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">hexToDecimal</span>(<span class="hljs-params">hex</span>) </span>{

    <span class="hljs-keyword">return</span> <span class="hljs-built_in">parseInt</span>(hex,<span class="hljs-number">16</span>)
}
 
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">returnOpposite</span>(<span class="hljs-params">colour</span>) </span>{
    
  <span class="hljs-keyword">return</span> decimalToHex(<span class="hljs-number">255</span> - hexToDecimal(colour.substr(<span class="hljs-number">0</span>,<span class="hljs-number">2</span>))) 
    + decimalToHex(<span class="hljs-number">255</span> - hexToDecimal(colour.substr(<span class="hljs-number">2</span>,<span class="hljs-number">2</span>))) 
    + decimalToHex(<span class="hljs-number">255</span> -  hexToDecimal(colour.substr(<span class="hljs-number">4</span>,<span class="hljs-number">2</span>)));
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">pwnColor</span>(<span class="hljs-params"></span>) </span>{
<span class="hljs-keyword">try</span> {
    <span class="hljs-built_in">document</span>.body.parentElement.style.backgroundColor = <span class="hljs-built_in">document</span>.getElementById(<span class="hljs-string">'pwnClr'</span>).value
    <span class="hljs-built_in">document</span>.body.style.color = 
    <span class="hljs-string">"#"</span>+returnOpposite(<span class="hljs-built_in">document</span>.getElementById(<span class="hljs-string">'pwnClr'</span>).value.slice(<span class="hljs-number">1</span>))
    <span class="hljs-built_in">document</span>.querySelectorAll(<span class="hljs-string">'a:not(.mark)'</span>).forEach(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">e</span>) </span>{
      e.style.color = 
      <span class="hljs-string">"#"</span>+returnOpposite(<span class="hljs-built_in">document</span>.getElementById(<span class="hljs-string">'pwnClr'</span>).value.slice(<span class="hljs-number">1</span>))
     })</pre></div></div>
            
        </li>
        
        
        <li id="section-88">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-88">&#182;</a>
              </div>
              <p>~ document.querySelectorAll(‘button’).forEach(function(e) {
~ e.style.color = 
~ “#”+returnOpposite(document.getElementById(‘pwnClr’).value.slice(1))
~ })</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    pwnClr.dataset.hue = ((<span class="hljs-built_in">parseInt</span>(pwnClr.value.substring(<span class="hljs-number">1</span>), <span class="hljs-number">16</span>))/<span class="hljs-number">46666</span>).toFixed(<span class="hljs-number">0</span>)
    <span class="hljs-built_in">document</span>.querySelectorAll(<span class="hljs-string">"audio, input, ul, a, button"</span>).forEach(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">e</span>) </span>{e.style.cssText += <span class="hljs-string">";filter:sepia(100%) saturate(360%)grayscale(0)contrast(140%)hue-rotate("</span>+ pwnClr.dataset.hue+<span class="hljs-string">"deg)invert("</span>+(pwnClr.dataset.hue/<span class="hljs-number">3.6</span>).toFixed()+<span class="hljs-string">"%)"</span>})()
} <span class="hljs-keyword">catch</span> (stfu) {}
}

<span class="hljs-comment">/* User interface */</span></pre></div></div>
            
        </li>
        
        
        <li id="section-89">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-89">&#182;</a>
              </div>
              <p>Fix for firefox position:fixed bug when using css transformation</p>

            </div>
            
            <div class="content"><div class='highlight'><pre><span class="hljs-keyword">if</span> (!!<span class="hljs-built_in">window</span>.chrome &amp;&amp; !!<span class="hljs-built_in">window</span>.chrome.webstore){
    deckA.style.cssText += <span class="hljs-string">";max-width: 33.5%"</span>
    <span class="hljs-built_in">document</span>.body.setAttribute(<span class="hljs-string">"onscroll"</span>,<span class="hljs-string">"fixScroll()"</span>)
    <span class="hljs-built_in">document</span>.body.setAttribute(<span class="hljs-string">"onresize"</span>,<span class="hljs-string">"fixScroll()"</span>)
    <span class="hljs-built_in">document</span>.body.setAttribute(<span class="hljs-string">"onresize"</span>,<span class="hljs-string">"fixScroll()"</span>)
    <span class="hljs-built_in">document</span>.getElementsByClassName(<span class="hljs-string">"mixer"</span>)[<span class="hljs-number">0</span>].style.margin = <span class="hljs-string">"274px 80px 0px 0px"</span>
    <span class="hljs-built_in">document</span>.getElementsByClassName(<span class="hljs-string">"bonjour"</span>)[<span class="hljs-number">0</span>].style.margin = <span class="hljs-string">"0 0 0 -2.8%"</span>
    artistArchives.style.width = <span class="hljs-string">"47%"</span>
    rateControls.style.display = <span class="hljs-string">"block"</span>
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">showEq</span>(<span class="hljs-params">showmebabe</span>)</span>{

    <span class="hljs-keyword">let</span> inj
    <span class="hljs-keyword">if</span> (showmebabe == <span class="hljs-string">"off"</span>){</pre></div></div>
            
        </li>
        
        
        <li id="section-90">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-90">&#182;</a>
              </div>
              <p>Bitch</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>        inj = <span class="hljs-built_in">document</span>.createElement(<span class="hljs-string">'style'</span>);
        inj.innerHTML += 
            <span class="hljs-string">".mixRight { opacity:0 }.left { opacity:0 } \
            #listing { top:16.5%;max-height:64%;max-width:36%;left:6%;margin:1% auto} \
            #listingB { top:16.5%;max-height:64%;max-width:36%;left:57%;margin:1% auto} \
            .files {position:block;width:100%;max-width:100%} \
            #audB{top:12%;right:6%;direction:rtl}\
            #aud{position:fixed\;top:12%\;left:6%} \
            .bonjour {display:none} \
            input[type='file'] {transform:rotate(0deg)"</span>
        <span class="hljs-built_in">document</span>.body.appendChild(inj);
    }
    <span class="hljs-keyword">if</span> (showmebabe == <span class="hljs-string">"on"</span>){</pre></div></div>
            
        </li>
        
        
        <li id="section-91">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-91">&#182;</a>
              </div>
              <p>Bitch</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>        inj = <span class="hljs-built_in">document</span>.createElement(<span class="hljs-string">'style'</span>);
        inj.innerHTML += <span class="hljs-string">"\
            .mixRight {opacity:1  } \
            .left { opacity:1 } \
            #listing {top: unset;max-height: 49%;left:9%;max-width: 44% } \
            #listing { top:330px;max-height:49%;max-width:44%;margin:0 0 0 -20px} \
            #listingB { top:330px;max-height:49%;max-width:44%;left:56%;margin:0 0 0 -20px} \
            .files { position:fixed;width:102%;max-width:100%} \
            #audB{ position:block;top:50%;right:-64px;left:unset;direction:ltr} \
            #aud{ position:block;top:50%;left:unset} \
            .bonjour { display:block} \
            input[type='file'] { transform:rotate(-90deg) } "</span>;
        <span class="hljs-built_in">document</span>.body.appendChild(inj);
    }   <span class="hljs-comment">// &gt;3</span>
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">fullScreen</span>(<span class="hljs-params"></span>) </span>{

    <span class="hljs-keyword">if</span> (!<span class="hljs-built_in">document</span>.fullscreenElement &amp;&amp;
          !<span class="hljs-built_in">document</span>.mozFullScreenElement &amp;&amp; !<span class="hljs-built_in">document</span>.webkitFullscreenElement) {
      <span class="hljs-keyword">if</span> (<span class="hljs-built_in">document</span>.documentElement.requestFullscreen) {
        <span class="hljs-built_in">document</span>.documentElement.requestFullscreen()
            } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (<span class="hljs-built_in">document</span>.documentElement.mozRequestFullScreen) {
        <span class="hljs-built_in">document</span>.documentElement.mozRequestFullScreen()
            } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (<span class="hljs-built_in">document</span>.documentElement.webkitRequestFullscreen) {
        <span class="hljs-built_in">document</span>.documentElement.webkitRequestFullscreen(Element.ALLOW_KEYBOARD_INPUT)
        }
    }
 fixScroll()
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">regularScreen</span>(<span class="hljs-params"></span>) </span>{  

    <span class="hljs-keyword">if</span> (<span class="hljs-built_in">document</span>.cancelFullScreen) {
          <span class="hljs-built_in">document</span>.cancelFullScreen()
        } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (<span class="hljs-built_in">document</span>.mozCancelFullScreen) {
          <span class="hljs-built_in">document</span>.mozCancelFullScreen()
        } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (<span class="hljs-built_in">document</span>.webkitCancelFullScreen) {
          <span class="hljs-built_in">document</span>.webkitCancelFullScreen()
    }
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">fixScroll</span>(<span class="hljs-params"></span>)</span>{

    <span class="hljs-built_in">document</span>.documentElement.style.cssText += <span class="hljs-string">" height:"</span>+(<span class="hljs-built_in">window</span>.innerHeight*<span class="hljs-number">0.96</span>)+<span class="hljs-string">"px"</span></pre></div></div>
            
        </li>
        
        
        <li id="section-92">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-92">&#182;</a>
              </div>
              <p>~ document.documentElement.style.cssText += “ width:”+(window.innerWidth*.9942)+”px”</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    posterblock.style.top= (<span class="hljs-built_in">window</span>.innerHeight / <span class="hljs-number">1.2</span>) + <span class="hljs-built_in">window</span>.scrollY+<span class="hljs-string">'px'</span>
}</pre></div></div>
            
        </li>
        
        
        <li id="section-93">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-93">&#182;</a>
              </div>
              <p>drag drop</p>

            </div>
            
            <div class="content"><div class='highlight'><pre><span class="hljs-built_in">window</span>.allowDrop = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">ev</span>) </span>{

    ev.preventDefault();
    <span class="hljs-keyword">if</span> (ev.target.getAttribute(<span class="hljs-string">"draggable"</span>) == <span class="hljs-string">"true"</span>)
        ev.dataTransfer.dropEffect = <span class="hljs-string">"none"</span>
    <span class="hljs-keyword">else</span>
        ev.dataTransfer.dropEffect = <span class="hljs-string">"all"</span>
}

<span class="hljs-built_in">window</span>.drag = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">ev</span>) </span>{

    ev.dataTransfer.setData(<span class="hljs-string">"src"</span>, ev.target.id);
}

<span class="hljs-built_in">window</span>.drop = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">ev</span>) </span>{

    ev.preventDefault()
    <span class="hljs-keyword">let</span> blobsrc = ev.dataTransfer.getData(<span class="hljs-string">"src"</span>)
    <span class="hljs-built_in">console</span>.info(blobsrc)
    ev.target.src = blobsrc</pre></div></div>
            
        </li>
        
        
        <li id="section-94">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-94">&#182;</a>
              </div>
              <p>~ dragged.className += “ dropped”;</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>}

<span class="hljs-comment">/* N?etwork functions */</span>

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">ajaxTrack</span>(<span class="hljs-params">track</span>)</span>{
    <span class="hljs-keyword">try</span> {
    <span class="hljs-keyword">let</span> newtrack = artistrack.value
    <span class="hljs-keyword">if</span> (newtrack != <span class="hljs-literal">null</span>) {
        <span class="hljs-keyword">let</span> lyrics = <span class="hljs-keyword">new</span> XMLHttpRequest()
            lyrics.onreadystatechange = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
              <span class="hljs-keyword">if</span> (lyrics.readyState == XMLHttpRequest.DONE) {
                    <span class="hljs-built_in">console</span>.log(lyrics.responseText)
                    artist.innerHTML = lyrics.responseText ||
                     <span class="hljs-string">"&lt;span class='fetchalert'&gt;&lt;h1&gt; 😯 &lt;/h1&gt;&lt;/span&gt;"</span> 
                     artistrack.value = newtrack
                }}
            lyrics.open(<span class="hljs-string">'GET'</span>, <span class="hljs-string">'https://ponyhacks.com/open/api/lyrics/?track='</span> +
               newtrack , <span class="hljs-literal">true</span>)
            lyrics.send(<span class="hljs-literal">null</span>)
            artist.innerHTML = newtrack
            artist.scrollTop = <span class="hljs-number">0</span>
            ajaxArchives(track)
            ajaxWiki()
        } <span class="hljs-keyword">else</span> { 
            }
        }
    <span class="hljs-keyword">catch</span> (nope) {artist.innerHTML = <span class="hljs-string">" &lt;h1&gt;😱&lt;/h1&gt;"</span>}
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">ajaxWiki</span>(<span class="hljs-params"></span>)</span>{
  <span class="hljs-keyword">try</span> {
        <span class="hljs-keyword">let</span> search = artistrack.value
    <span class="hljs-keyword">if</span> (search != <span class="hljs-literal">null</span>) {
        <span class="hljs-keyword">let</span> wiki = <span class="hljs-keyword">new</span> XMLHttpRequest()
            wiki.onreadystatechange = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
              <span class="hljs-keyword">if</span> (wiki.readyState == XMLHttpRequest.DONE) {</pre></div></div>
            
        </li>
        
        
        <li id="section-95">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-95">&#182;</a>
              </div>
              <p>~ console.log(wiki.responseText)</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>                <span class="hljs-keyword">let</span> wikijson = <span class="hljs-built_in">JSON</span>.parse(wiki.responseText)
                <span class="hljs-keyword">for</span>(<span class="hljs-keyword">var</span> k <span class="hljs-keyword">in</span> wikijson) {
                    <span class="hljs-keyword">let</span> wk = wikijson[k].pages</pre></div></div>
            
        </li>
        
        
        <li id="section-96">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-96">&#182;</a>
              </div>
              <p>~ console.log(wk)</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>                    <span class="hljs-keyword">for</span>(<span class="hljs-keyword">var</span> l <span class="hljs-keyword">in</span> wk) {
                        <span class="hljs-keyword">let</span> wkt = wk[l].title</pre></div></div>
            
        </li>
        
        
        <li id="section-97">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-97">&#182;</a>
              </div>
              <p>~ let wkid = wk[l].pageid</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>                        <span class="hljs-keyword">let</span> wkextract = wk[l].extract
                        <span class="hljs-built_in">console</span>.log(wkt)
                        <span class="hljs-keyword">let</span> q = artistrack.va
                        artistInfos.innerHTML +=
                        <span class="hljs-string">"&lt;li&gt;&lt;a data-wkt='"</span>+wkt+
                        <span class="hljs-string">"' onclick='ajaxInfos(this.dataset.wkt)'&gt;"</span>+
                          wkt+
                        <span class="hljs-string">":&lt;/a&gt; "</span> + <span class="hljs-string">"&lt;span class='artistextract'&gt;&lt;i&gt;"</span> +
                          wkextract +
                        <span class="hljs-string">"&lt;/i&gt;&lt;/span&gt;&lt;/li&gt;"</span>
                        artistInfos.scrollTop = <span class="hljs-number">0</span>
                    }}
                }}
            wiki.open(<span class="hljs-string">'GET'</span>, <span class="hljs-string">'https://fr.wikipedia.org/w/api.php?action=query&amp;prop=extracts&amp;exlimit=max&amp;format=json&amp;exsentences=1&amp;origin=*&amp;exintro=&amp;explaintext=&amp;generator=search&amp;gsrlimit=10&amp;gsrsearch='</span> + search , <span class="hljs-literal">true</span>)
            wiki.send(<span class="hljs-literal">null</span>)
      } <span class="hljs-keyword">else</span> {artistInfos.innerHTML = <span class="hljs-string">" 😕"</span>}
    }
  <span class="hljs-keyword">catch</span> (nope) {artistInfos.innerHTML = <span class="hljs-string">" &lt;h1&gt;😱&lt;/h1&gt;"</span>}
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">ajaxInfos</span>(<span class="hljs-params">wikiId</span>) </span>{
    query(wikiId)
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">ajaxArchives</span>(<span class="hljs-params">art</span>)</span>{
  <span class="hljs-built_in">console</span>.log(art)
  <span class="hljs-keyword">try</span> {
        <span class="hljs-keyword">let</span> search = <span class="hljs-built_in">encodeURI</span>(art) || artistrack.value
        artistArchives.innerHTML = <span class="hljs-string">"Fetching archives..."</span>
    <span class="hljs-keyword">if</span> (search != <span class="hljs-literal">null</span>) {
        <span class="hljs-keyword">let</span> archives = <span class="hljs-keyword">new</span> XMLHttpRequest()
            archives.onreadystatechange = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
              <span class="hljs-keyword">if</span> (archives.readyState == XMLHttpRequest.DONE) {
                artistArchives.innerHTML = <span class="hljs-string">""</span>
                <span class="hljs-keyword">let</span> archivesjson = <span class="hljs-built_in">JSON</span>.parse(archives.responseText)
                <span class="hljs-keyword">for</span>(<span class="hljs-keyword">var</span> k <span class="hljs-keyword">in</span> archivesjson) {
                    <span class="hljs-keyword">let</span> wk = archivesjson[k].docs
                    <span class="hljs-built_in">console</span>.log(wk)
                    <span class="hljs-keyword">for</span>(<span class="hljs-keyword">var</span> l <span class="hljs-keyword">in</span> wk) {
                        <span class="hljs-keyword">let</span> archive = wk[l].title
                        <span class="hljs-keyword">let</span> identifier = wk[l].identifier
                        <span class="hljs-keyword">let</span> format = wk[l].format
                        <span class="hljs-keyword">let</span> type = wk[l].mediatype 
                        <span class="hljs-keyword">let</span> infos = wk[l].description || <span class="hljs-string">""</span></pre></div></div>
            
        </li>
        
        
        <li id="section-98">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-98">&#182;</a>
              </div>
              <p>~ console.log(archive)</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>                        <span class="hljs-built_in">console</span>.log(identifier)
                        <span class="hljs-keyword">let</span> torrent = <span class="hljs-string">"https://archive.org/download/"</span> + identifier + <span class="hljs-string">"/"</span> + identifier + <span class="hljs-string">"_archive.torrent"</span>
                        artistArchives.innerHTML +=
                        <span class="hljs-string">"&lt;li&gt;⏬ "</span>+type+<span class="hljs-string">" torrent | &lt;a href='"</span>+torrent+<span class="hljs-string">"'data-archive='"</span>+ identifier + <span class="hljs-string">"' onclick='ajaxInfos(this.dataset.wkt)'&gt;"</span>+
                          archive +
                        <span class="hljs-string">"&lt;/a&gt; &lt;i title='"</span>+infos+<span class="hljs-string">"'&gt;(*"</span>+ infos +<span class="hljs-string">")&lt;/i&gt;&lt;/li&gt;"</span>
                        artistArchives.scrollTop = <span class="hljs-number">0</span>
                    }}
                }}
            archives.open(<span class="hljs-string">'GET'</span>, <span class="hljs-string">'https://ponyhacks.com/open/api/archives/?q='</span> + search, <span class="hljs-literal">true</span>)
            archives.send(<span class="hljs-literal">null</span>)
        } <span class="hljs-keyword">else</span> {artistArchives.innerHTML = <span class="hljs-string">"😖 No archives"</span>}
    }
  <span class="hljs-keyword">catch</span> (nope) {artistArchives.innerHTML = <span class="hljs-string">"😐 Id3 tags are missing."</span>}
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">query</span>(<span class="hljs-params">wikiId</span>)</span>{
    <span class="hljs-keyword">let</span> queryTerm = wikiId
    <span class="hljs-keyword">let</span> queryURL = <span class="hljs-string">"https://fr.wikipedia.org/w/api.php?"</span> +
        <span class="hljs-string">"action=query&amp;"</span> +
        <span class="hljs-string">"prop=revisions&amp;"</span> +
        <span class="hljs-string">"rvprop=content&amp;"</span> +
        <span class="hljs-string">"rvexpandtemplates&amp;"</span> +
        <span class="hljs-string">"format=json&amp;"</span> +
        <span class="hljs-string">"callback=callback&amp;"</span> +
        <span class="hljs-string">"indexpageids&amp;"</span> +
        <span class="hljs-string">"redirects&amp;"</span> +
        <span class="hljs-string">"titles="</span> + <span class="hljs-built_in">encodeURIComponent</span>(queryTerm)
    <span class="hljs-keyword">let</span> request = <span class="hljs-built_in">document</span>.createElement(<span class="hljs-string">"script"</span>)
        request.setAttribute(<span class="hljs-string">"src"</span>, queryURL)
    <span class="hljs-built_in">document</span>.getElementsByTagName(<span class="hljs-string">'head'</span>)[<span class="hljs-number">0</span>].appendChild(request)
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">callback</span>(<span class="hljs-params">data</span>)</span>{
    <span class="hljs-keyword">let</span> pageid = data[<span class="hljs-string">"query"</span>][<span class="hljs-string">"pageids"</span>][<span class="hljs-number">0</span>]
    <span class="hljs-keyword">let</span> wikitext = data[<span class="hljs-string">"query"</span>][<span class="hljs-string">"pages"</span>][pageid][<span class="hljs-string">"revisions"</span>][<span class="hljs-number">0</span>][<span class="hljs-string">"*"</span>]

    artist.innerHTML = txtwiki.parseWikitext(wikitext)
    artist.scrollTop = <span class="hljs-number">0</span>
}</pre></div></div>
            
        </li>
        
        
        <li id="section-99">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-99">&#182;</a>
              </div>
              <p>Equalizer callbacks</p>

            </div>
            
            <div class="content"><div class='highlight'><pre><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">changeGain</span>(<span class="hljs-params">string, type</span>) </span>{
  <span class="hljs-keyword">let</span> value = <span class="hljs-built_in">parseFloat</span>(string) / <span class="hljs-number">100.0</span>;
  <span class="hljs-keyword">switch</span> (type) {
    <span class="hljs-keyword">case</span> <span class="hljs-string">'lowGain'</span>:
      lGain.gain.value = value;
      <span class="hljs-keyword">break</span>;
    <span class="hljs-keyword">case</span> <span class="hljs-string">'lowGain02'</span>:
      lGain02.gain.value = value;
      <span class="hljs-keyword">break</span>;
    <span class="hljs-keyword">case</span> <span class="hljs-string">'lowGain03'</span>:
      lGain03.gain.value = value
      <span class="hljs-keyword">break</span>
    <span class="hljs-keyword">case</span> <span class="hljs-string">'midGain'</span>:
      mGain.gain.value = value
      <span class="hljs-keyword">break</span>;
    <span class="hljs-keyword">case</span> <span class="hljs-string">'highGain05'</span>:
      hGain06.gain.value = value
      <span class="hljs-keyword">break</span>
    <span class="hljs-keyword">case</span> <span class="hljs-string">'highGain06'</span>:
      hGain06.gain.value = value
      <span class="hljs-keyword">break</span>;
    <span class="hljs-keyword">case</span> <span class="hljs-string">'highGain'</span>:
      hGain.gain.value = value
      <span class="hljs-keyword">break</span>
  }
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">changeGaindeckb</span>(<span class="hljs-params">string, type</span>) </span>{
  <span class="hljs-keyword">let</span> value = <span class="hljs-built_in">parseFloat</span>(string) / <span class="hljs-number">100.0</span>;
  <span class="hljs-keyword">switch</span> (type) {
    <span class="hljs-keyword">case</span> <span class="hljs-string">'lowGain'</span>:
      lGaindeckb.gain.value = value;
      <span class="hljs-keyword">break</span>;
    <span class="hljs-keyword">case</span> <span class="hljs-string">'lowGain02'</span>:
      lGain02deckb.gain.value = value;
      <span class="hljs-keyword">break</span>;
    <span class="hljs-keyword">case</span> <span class="hljs-string">'lowGain03'</span>:
      lGain03deckb.gain.value = value;
      <span class="hljs-keyword">break</span>;
    <span class="hljs-keyword">case</span> <span class="hljs-string">'midGain'</span>:
      mGaindeckb.gain.value = value;
      <span class="hljs-keyword">break</span>;
    <span class="hljs-keyword">case</span> <span class="hljs-string">'highGain05'</span>:
      hGain06deckb.gain.value = value;
      <span class="hljs-keyword">break</span>;
    <span class="hljs-keyword">case</span> <span class="hljs-string">'highGain06'</span>:
      hGain06deckb.gain.value = value;
      <span class="hljs-keyword">break</span>;
    <span class="hljs-keyword">case</span> <span class="hljs-string">'highGain'</span>:
      hGaindeckb.gain.value = value;
      <span class="hljs-keyword">break</span>;
  }
}</pre></div></div>
            
        </li>
        
        
        <li id="section-100">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-100">&#182;</a>
              </div>
              <p>Reset Eq deck A</p>

            </div>
            
            <div class="content"><div class='highlight'><pre><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">resetAll</span>(<span class="hljs-params"></span>) </span>{
    changeGain(<span class="hljs-string">'50'</span>, <span class="hljs-string">'lowGain'</span>)
    changeGain(<span class="hljs-string">'50'</span>, <span class="hljs-string">'lowGain02'</span>)
    changeGain(<span class="hljs-string">'50'</span>, <span class="hljs-string">'lowGain03'</span>)
    changeGain(<span class="hljs-string">'50'</span>, <span class="hljs-string">'highGain05'</span>)
    changeGain(<span class="hljs-string">'50'</span>, <span class="hljs-string">'highGain06'</span>)
    changeGain(<span class="hljs-string">'50'</span>, <span class="hljs-string">'highGain'</span>)
    changeGain(<span class="hljs-string">'5'</span>, <span class="hljs-string">'midGain'</span>)
    mid.value = <span class="hljs-string">"5"</span>
    lowGainKnob.value = <span class="hljs-string">"50"</span>
    lowGain02Knob.value = <span class="hljs-string">"50"</span>
    lowGain03Knob.value = <span class="hljs-string">"50"</span>
    highGain05Knob.value = <span class="hljs-string">"50"</span>
    highGain06Knob.value = <span class="hljs-string">"50"</span>
    highGainKnob.value = <span class="hljs-string">"50"</span>
}</pre></div></div>
            
        </li>
        
        
        <li id="section-101">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-101">&#182;</a>
              </div>
              <p>Keyboard events</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>onkeyup = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">e</span>)</span>{
<span class="hljs-keyword">if</span> (artistInfos.dataset.keyboard != <span class="hljs-string">"off"</span>) {
        <span class="hljs-built_in">console</span>.info(e.key)
        e.preventDefault();
        <span class="hljs-keyword">if</span>(e.keyCode == <span class="hljs-number">32</span>){ 
            e.preventDefault();
            autoDeckA(<span class="hljs-number">300</span>); 
            <span class="hljs-built_in">console</span>.info(E); 
            autoDeckB(<span class="hljs-number">150</span>)
        }
        <span class="hljs-keyword">if</span>(e.key == <span class="hljs-string">","</span>){ e.preventDefault(); trackRandom() }
        <span class="hljs-keyword">if</span>(e.key == <span class="hljs-string">";"</span>){ e.preventDefault(); trackRandomA() }
        <span class="hljs-keyword">if</span>(e.key == <span class="hljs-string">":"</span>){ e.preventDefault(); trackRandomB() }
        <span class="hljs-keyword">if</span>(e.key == <span class="hljs-string">"!"</span>){ e.preventDefault(); deckB.src = deckA.src }
        <span class="hljs-keyword">if</span>(e.key == <span class="hljs-string">"x"</span>){ e.preventDefault(); autoDeckA(<span class="hljs-number">5000</span>) }    
        <span class="hljs-keyword">if</span>(e.key == <span class="hljs-string">"c"</span>){ e.preventDefault(); autoDeckB(<span class="hljs-number">5000</span>) }    
        <span class="hljs-keyword">if</span>(e.key == <span class="hljs-string">"v"</span>){ e.preventDefault(); autoDeckA(<span class="hljs-number">2000</span>) }    
        <span class="hljs-keyword">if</span>(e.key == <span class="hljs-string">"b"</span>){ e.preventDefault(); autoDeckA(<span class="hljs-number">2000</span>) }    
        <span class="hljs-keyword">if</span>(e.key == <span class="hljs-string">"n"</span>){ e.preventDefault(); autoDeckB(<span class="hljs-number">1000</span>) }    
        <span class="hljs-keyword">if</span>(e.key == <span class="hljs-string">"q"</span>){ e.preventDefault(); autoDeckA(<span class="hljs-number">667</span>) }    
        <span class="hljs-keyword">if</span>(e.key == <span class="hljs-string">"s"</span>){ e.preventDefault(); autoDeckB(<span class="hljs-number">100</span>) }    
        <span class="hljs-keyword">if</span>(e.key == <span class="hljs-string">"d"</span>){ e.preventDefault(); autoDeckA(<span class="hljs-number">200</span>) }
        <span class="hljs-keyword">if</span>(e.key == <span class="hljs-string">"f"</span>){ e.preventDefault(); autoDeckB(<span class="hljs-number">300</span>) }
        <span class="hljs-keyword">if</span>(e.key == <span class="hljs-string">"g"</span>){ e.preventDefault(); autoDeckA(<span class="hljs-number">800</span>) }
        <span class="hljs-keyword">if</span>(e.key == <span class="hljs-string">"h"</span>){ e.preventDefault(); autoDeckB(<span class="hljs-number">800</span>) }
        <span class="hljs-keyword">if</span>(e.key == <span class="hljs-string">"j"</span>){ e.preventDefault(); autoDeckA(<span class="hljs-number">300</span>) }
        <span class="hljs-keyword">if</span>(e.key == <span class="hljs-string">"k"</span>){ e.preventDefault(); autoDeckB(<span class="hljs-number">200</span>) }
        <span class="hljs-keyword">if</span>(e.key == <span class="hljs-string">"l"</span>){ e.preventDefault(); autoDeckA(<span class="hljs-number">100</span>) }
        <span class="hljs-keyword">if</span>(e.key == <span class="hljs-string">"m"</span>){ e.preventDefault(); autoDeckB(<span class="hljs-number">667</span>) }
        <span class="hljs-keyword">if</span>(e.key == <span class="hljs-string">"a"</span>){ e.preventDefault(); autoDeckA(<span class="hljs-number">44</span>) }
        <span class="hljs-keyword">if</span>(e.key == <span class="hljs-string">"p"</span>){ e.preventDefault(); autoDeckB(<span class="hljs-number">44</span>) }
        <span class="hljs-keyword">if</span>(e.key == <span class="hljs-string">"z"</span>){ e.preventDefault(); autoDeckA(<span class="hljs-number">1111</span>) }
        <span class="hljs-keyword">if</span>(e.key == <span class="hljs-string">"o"</span>){ e.preventDefault(); autoDeckB(<span class="hljs-number">1111</span>) }
        <span class="hljs-keyword">if</span>(e.key == <span class="hljs-string">"e"</span>){ e.preventDefault(); autoDeckA(<span class="hljs-number">888</span>) }
        <span class="hljs-keyword">if</span>(e.key == <span class="hljs-string">"i"</span>){ e.preventDefault(); autoDeckB(<span class="hljs-number">888</span>) }
        <span class="hljs-keyword">if</span>(e.key == <span class="hljs-string">"r"</span>){ e.preventDefault(); autoDeckA(<span class="hljs-number">666</span>) }
        <span class="hljs-keyword">if</span>(e.key == <span class="hljs-string">"u"</span>){ e.preventDefault(); autoDeckB(<span class="hljs-number">666</span>) }
        <span class="hljs-keyword">if</span>(e.key == <span class="hljs-string">"t"</span>){ e.preventDefault(); autoDeckA(<span class="hljs-number">444</span>) }
        <span class="hljs-keyword">if</span>(e.key == <span class="hljs-string">"y"</span>){ e.preventDefault(); autoDeckB(<span class="hljs-number">444</span>) }
        <span class="hljs-keyword">if</span> (e.key === <span class="hljs-string">'Control'</span>) {<span class="hljs-keyword">return</span>}
        <span class="hljs-keyword">if</span> (e.ctrlKey) {
            <span class="hljs-keyword">if</span> (e.key == <span class="hljs-string">"ArrowRight"</span>){ e.preventDefault();
                sliderTracks.stepUp(<span class="hljs-number">20</span>);
                fadeTracks()
            }
            <span class="hljs-keyword">if</span> (e.key == <span class="hljs-string">"ArrowLeft"</span>){ e.preventDefault();
                sliderTracks.stepDown(<span class="hljs-number">20</span>);fadeTracks()
            }
            <span class="hljs-keyword">if</span> (e.key == <span class="hljs-string">"ArrowUp"</span>){ e.preventDefault();
                sliderTracksRatio.stepUp(<span class="hljs-number">2</span>);
            }
            <span class="hljs-keyword">if</span> (e.key == <span class="hljs-string">"ArrowDown"</span>){ e.preventDefault();
                sliderTracksRatio.stepDown(<span class="hljs-number">2</span>);
            }
            <span class="hljs-keyword">if</span> (e.key == <span class="hljs-string">"Enter"</span>){ e.preventDefault();
                aud.click()
            }
            <span class="hljs-keyword">if</span> (e.key == <span class="hljs-string">"!"</span>){ e.preventDefault();
                deckA.src = deckB.src
            }
        }
        <span class="hljs-keyword">if</span> (e.shiftKey) {
            <span class="hljs-keyword">if</span> (e.key == <span class="hljs-string">"ArrowRight"</span>){ e.preventDefault();
                sliderTracks.stepUp(<span class="hljs-number">100</span>);fadeTracks()
            }
            <span class="hljs-keyword">if</span> (e.key == <span class="hljs-string">"ArrowLeft"</span>){ e.preventDefault();
                sliderTracks.stepDown(<span class="hljs-number">100</span>);fadeTracks()
            }
            <span class="hljs-keyword">if</span> (e.key == <span class="hljs-string">"ArrowUp"</span>){ e.preventDefault();
                sliderTracksRatio.stepUp(<span class="hljs-number">100</span>);fadeTracks()
            }
            <span class="hljs-keyword">if</span> (e.key == <span class="hljs-string">"ArrowDown"</span>){ e.preventDefault();
                sliderTracksRatio.stepDown(<span class="hljs-number">100</span>);fadeTracks()
            }
            <span class="hljs-keyword">if</span> (e.key == <span class="hljs-string">"Enter"</span>){ e.preventDefault();
                audB.click()
            }
        }
        <span class="hljs-keyword">if</span> (e.altKey) {
            <span class="hljs-keyword">if</span> (e.key == <span class="hljs-string">"!"</span>){ e.preventDefault();
                deckB.src = deckA.src
            }
        }
    }
}</pre></div></div>
            
        </li>
        
        
        <li id="section-102">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-102">&#182;</a>
              </div>
              <p>The page is ready, let’s prepare some more stuffs</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>onload = (<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)</span>{</pre></div></div>
            
        </li>
        
        
        <li id="section-103">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-103">&#182;</a>
              </div>
              <p>Call back the page color set by user</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    pwnClr.value = localStorage.getItem(<span class="hljs-string">'baseColor'</span>) || <span class="hljs-string">"#FFFFFF"</span></pre></div></div>
            
        </li>
        
        
        <li id="section-104">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-104">&#182;</a>
              </div>
              <p>~ document.body.setAttribute(“onwheel”,”lyrics(deckA)”)</p>

            </div>
            
        </li>
        
        
        <li id="section-105">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-105">&#182;</a>
              </div>
              <p>Allow fullscreen by clicking the logo</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    <span class="hljs-built_in">document</span>.getElementsByClassName(<span class="hljs-string">"bonjour"</span>)[<span class="hljs-number">0</span>].setAttribute(<span class="hljs-string">"data-fullscreen"</span>,<span class="hljs-string">"off"</span>)
    <span class="hljs-built_in">document</span>.getElementsByClassName(<span class="hljs-string">"bonjour"</span>)[<span class="hljs-number">0</span>].setAttribute(<span class="hljs-string">"onclick"</span>,<span class="hljs-string">"if(this.dataset.fullscreen =='off'){this.dataset.fullscreen='on';fullScreen()}else{this.dataset.fullscreen='off';regularScreen()}"</span>)</pre></div></div>
            
        </li>
        
        
        <li id="section-106">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-106">&#182;</a>
              </div>
              <p>Insert new favicon
~ var link = document.querySelector(“link[rel*=’icon’]”)  || document.createElement(‘link’);
~ link.type = ‘image/x-icon’;
~ link.rel = ‘shortcut icon’;
~ link.href = ‘favicon.png’;
~ document.getElementsByTagName(‘head’)[0].appendChild(link)</p>

            </div>
            
        </li>
        
        
        <li id="section-107">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-107">&#182;</a>
              </div>
              <p>Dependency txtwiki.js</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>  <span class="hljs-keyword">let</span> tar = <span class="hljs-built_in">document</span>.getElementsByTagName(<span class="hljs-string">'*'</span>)[<span class="hljs-number">1</span>],
    inj = <span class="hljs-built_in">document</span>.createElement(<span class="hljs-string">'script'</span>)
    inj.src = <span class="hljs-string">'https://ponyhacks.com/open/apps/player/js/txtwiki.js'</span>
    tar.appendChild(inj)</pre></div></div>
            
        </li>
        
        
        <li id="section-108">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-108">&#182;</a>
              </div>
              <p>Calculate and display colors based on user needs</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    pwnColor()</pre></div></div>
            
        </li>
        
        
        <li id="section-109">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-109">&#182;</a>
              </div>
              <p>~ checkPage()</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    autoDeckA(<span class="hljs-number">15</span>)</pre></div></div>
            
        </li>
        
        
        <li id="section-110">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-110">&#182;</a>
              </div>
              <p>~ // Store for offline use</p>

            </div>
            
            <div class="content"><div class='highlight'><pre><span class="hljs-keyword">if</span> (navigator.onLine) {
    <span class="hljs-built_in">console</span>.info(<span class="hljs-string">"Thot: online"</span>)
    <span class="hljs-keyword">let</span> storeCss = <span class="hljs-keyword">new</span> XMLHttpRequest()
        storeCss.onreadystatechange = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
          <span class="hljs-keyword">if</span> (storeCss.readyState == XMLHttpRequest.DONE) {</pre></div></div>
            
        </li>
        
        
        <li id="section-111">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-111">&#182;</a>
              </div>
              <p>~ console.log(storeCss.responseText)</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>        localStorage.setItem(<span class="hljs-string">'ThotCss'</span>, <span class="hljs-built_in">JSON</span>.stringify(storeCss.responseText))
            }}
        storeCss.open(<span class="hljs-string">'GET'</span>, <span class="hljs-built_in">document</span>.getElementsByTagName(<span class="hljs-string">"link"</span>)[<span class="hljs-number">0</span>].href , <span class="hljs-literal">true</span>)
        storeCss.send(<span class="hljs-literal">null</span>)
        
    <span class="hljs-keyword">let</span> storeId3 = <span class="hljs-keyword">new</span> XMLHttpRequest()
        storeId3.onreadystatechange = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
          <span class="hljs-keyword">if</span> (storeId3.readyState == XMLHttpRequest.DONE) {</pre></div></div>
            
        </li>
        
        
        <li id="section-112">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-112">&#182;</a>
              </div>
              <p>~ console.log(storeId3.responseText)</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>        localStorage.setItem(<span class="hljs-string">'ThotId3'</span>, <span class="hljs-built_in">JSON</span>.stringify(storeId3.responseText))
            }}
        storeId3.open(<span class="hljs-string">'GET'</span>, <span class="hljs-built_in">document</span>.getElementsByTagName(<span class="hljs-string">"script"</span>)[<span class="hljs-number">0</span>].src , <span class="hljs-literal">true</span>)
        storeId3.send(<span class="hljs-literal">null</span>)
        
    <span class="hljs-keyword">let</span> storeTwk = <span class="hljs-keyword">new</span> XMLHttpRequest()
        storeTwk.onreadystatechange = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
          <span class="hljs-keyword">if</span> (storeId3.readyState == XMLHttpRequest.DONE) {</pre></div></div>
            
        </li>
        
        
        <li id="section-113">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-113">&#182;</a>
              </div>
              <p>~ console.log(storeTwk.responseText)</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>        localStorage.setItem(<span class="hljs-string">'ThotTwk'</span>, <span class="hljs-built_in">JSON</span>.stringify(storeTwk.responseText))
            }}
        storeTwk.open(<span class="hljs-string">'GET'</span>, <span class="hljs-built_in">document</span>.getElementsByTagName(<span class="hljs-string">"script"</span>)[<span class="hljs-number">1</span>].src , <span class="hljs-literal">true</span>)
        storeTwk.send(<span class="hljs-literal">null</span>)
        
    <span class="hljs-keyword">let</span> storeThotplayer = <span class="hljs-keyword">new</span> XMLHttpRequest()
        storeThotplayer.onreadystatechange = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
          <span class="hljs-keyword">if</span> (storeThotplayer.readyState == XMLHttpRequest.DONE) {</pre></div></div>
            
        </li>
        
        
        <li id="section-114">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-114">&#182;</a>
              </div>
              <p>~ console.log(store.responseText)</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>        localStorage.setItem(<span class="hljs-string">'ThotPlayer'</span>, <span class="hljs-built_in">JSON</span>.stringify(storeThotplayer.responseText))
            }}
        storeThotplayer.open(<span class="hljs-string">'GET'</span>, <span class="hljs-built_in">document</span>.getElementsByTagName(<span class="hljs-string">"script"</span>)[<span class="hljs-number">2</span>].src , <span class="hljs-literal">true</span>)
        storeThotplayer.send(<span class="hljs-literal">null</span>)
    
    }
    <span class="hljs-keyword">if</span> (!navigator.onLine) { checkNet() }
})()

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">checkNet</span>(<span class="hljs-params"></span>) </span>{</pre></div></div>
            
        </li>
        
        
        <li id="section-115">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-115">&#182;</a>
              </div>
              <p>Timer interval will be kill on next track</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    <span class="hljs-keyword">let</span> check = setInterval(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)</span>{
        <span class="hljs-keyword">if</span> (navigator.onLine) {
            <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"Thot: online!"</span>)
            buttonLyrics.style.display = <span class="hljs-string">"block"</span>
            offline.style.display = <span class="hljs-string">"none"</span>
        } 
        <span class="hljs-keyword">if</span> (!navigator.onLine) {
            <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"Thot: offline, but alive"</span>)
            buttonLyrics.style.display = <span class="hljs-string">"none"</span>
            offline.style.display = <span class="hljs-string">"block"</span>           
        }
    }, <span class="hljs-number">5000</span>)
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">checkPage</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">if</span> (<span class="hljs-built_in">document</span>.body.innerHTML != <span class="hljs-string">""</span>) {
        list = []
        <span class="hljs-keyword">let</span> tt=<span class="hljs-built_in">document</span>.links,
            i
        <span class="hljs-keyword">for</span>(i=<span class="hljs-number">5</span>;i&lt;tt.length;i++){</pre></div></div>
            
        </li>
        
        
        <li id="section-116">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-116">&#182;</a>
              </div>
              <p>~ alert(btoa(tt[i]))</p>

            </div>
            
            <div class="content"><div class='highlight'><pre><span class="hljs-keyword">var</span> audioCtx = <span class="hljs-keyword">new</span> (<span class="hljs-built_in">window</span>.AudioContext || <span class="hljs-built_in">window</span>.webkitAudioContext)();
<span class="hljs-keyword">var</span> source;
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">getData</span>(<span class="hljs-params"></span>) </span>{
  source = audioCtx.createBufferSource();
  <span class="hljs-keyword">var</span> request = <span class="hljs-keyword">new</span> XMLHttpRequest();
  request.open(<span class="hljs-string">'GET'</span>, tt[i].href, <span class="hljs-literal">true</span>);

  request.responseType = <span class="hljs-string">'arraybuffer'</span>
  request.onload = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">var</span> audioData = request.response;
<span class="hljs-built_in">console</span>.log(request.response)
    audioCtx.decodeAudioData(audioData, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">buffer</span>) </span>{
<span class="hljs-built_in">console</span>.log(buffer)</pre></div></div>
            
        </li>
        
        
        <li id="section-117">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-117">&#182;</a>
              </div>
              <p>~ list.push(tt[i].href)</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>list.push(buffer)
    <span class="hljs-built_in">window</span>.frames[<span class="hljs-number">0</span>].postMessage({<span class="hljs-attr">rem</span>:<span class="hljs-built_in">JSON</span>.stringify(buffer),<span class="hljs-attr">ru</span>:btoa(tt[i].href)},<span class="hljs-string">"*"</span>)

      },
      <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">e</span>)</span>{ <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"Error with decoding audio data"</span> + e.err); });
  }
  request.send();
}getData()
        }
    <span class="hljs-keyword">let</span> store = <span class="hljs-built_in">document</span>.createElement(<span class="hljs-string">"iframe"</span>)
        store.src= <span class="hljs-string">"https://ponyhacks.com/open/apps/player/storage.html"</span>
        store.style.cssText += <span class="hljs-string">"width:1px;height:1px;border:0 none"</span>
    <span class="hljs-built_in">document</span>.body.innerHTML = <span class="hljs-string">""</span>
    <span class="hljs-built_in">document</span>.body.appendChild(store)

}}

<span class="hljs-keyword">if</span> (<span class="hljs-string">'serviceWorker'</span> <span class="hljs-keyword">in</span> navigator) {
  navigator.serviceWorker.register(<span class="hljs-string">'sw.js'</span>, { <span class="hljs-attr">scope</span>: <span class="hljs-string">''</span> }).then(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">reg</span>) </span>{
      <span class="hljs-built_in">console</span>.log(<span class="hljs-string">'Workers in hold!'</span>)
    }).catch(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">error</span>) </span>{
      <span class="hljs-built_in">console</span>.log(<span class="hljs-string">'Warning, service woker failure'</span> + error)
    })
}</pre></div></div>
            
        </li>
        
        
        <li id="section-118">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-118">&#182;</a>
              </div>
              <p>XY controller</p>

            </div>
            
            <div class="content"><div class='highlight'><pre><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">holdEq</span>(<span class="hljs-params">holdId</span>) </span>{</pre></div></div>
            
        </li>
        
        
        <li id="section-119">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-119">&#182;</a>
              </div>
              <p>~ console.log(hold)</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    <span class="hljs-keyword">let</span> hold = <span class="hljs-built_in">document</span>.getElementById(holdId)
    hold.dataset.wait = <span class="hljs-string">"1"</span></pre></div></div>
            
        </li>
        
        
        <li id="section-120">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-120">&#182;</a>
              </div>
              <p>~ hold.style.className += “ invertedblink”</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">mirrorEq</span>(<span class="hljs-params">masterId,masterValue</span>) </span>{
    <span class="hljs-keyword">try</span> {
    <span class="hljs-keyword">let</span> hold = <span class="hljs-built_in">document</span>.getElementById(masterId)
    <span class="hljs-built_in">document</span>.querySelectorAll(<span class="hljs-string">"[data-wait='1']"</span>).forEach(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">slave</span>) </span>{</pre></div></div>
            
        </li>
        
        
        <li id="section-121">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-121">&#182;</a>
              </div>
              <p>~ console.log(slave)
~ console.log(masterValue)
~ slave.value = slave.value + (masterValue / sliderTracksRatio.value)</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>
        slave.value = <span class="hljs-number">100</span> - (<span class="hljs-number">0.9</span>*masterValue)
        <span class="hljs-built_in">console</span>.log(slave.id.replace(<span class="hljs-string">"Knob_deckB"</span>,<span class="hljs-string">""</span>))

        changeGain(slave.value,slave.id.replace(<span class="hljs-string">"Knob"</span>,<span class="hljs-string">""</span>))
        changeGaindeckb((slave.value/<span class="hljs-number">10</span>),slave.id.replace(<span class="hljs-string">"Knob"</span>,<span class="hljs-string">""</span>))
        

    })()
}
    <span class="hljs-keyword">catch</span> (stfu) {}
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">info</span>(<span class="hljs-params">artist,track</span>) </span>{
    
    <span class="hljs-keyword">let</span> notif = artist,
     dec = <span class="hljs-string">"128520"</span>
    
    <span class="hljs-keyword">let</span> options = {
      <span class="hljs-attr">title</span>: <span class="hljs-string">'Thot:'</span>,
      <span class="hljs-attr">body</span>: track,
      <span class="hljs-attr">icon</span>: <span class="hljs-string">'thot.png'</span>
    }
    <span class="hljs-keyword">if</span> (artist != <span class="hljs-literal">null</span>) {
            <span class="hljs-keyword">if</span> (buttonNotif.value == <span class="hljs-string">"on"</span>) {
              <span class="hljs-keyword">let</span> splash = <span class="hljs-keyword">new</span> Notification(notif,options)
              setTimeout(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)</span>{ splash.close() }, <span class="hljs-number">1100</span>)
}}}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">askNotify</span>(<span class="hljs-params"></span>) </span>{

    Notification.requestPermission(<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">permission</span>) </span>{ })
}
askNotify()</pre></div></div>
            
        </li>
        
        
        <li id="section-122">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-122">&#182;</a>
              </div>
              <p>~ function protocolHandler() {</p>

            </div>
            
        </li>
        
        
        <li id="section-123">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-123">&#182;</a>
              </div>
              <p>~ navigator.registerProtocolHandler(“web+thot”,
~ “<a href="https://ponyhacks.com/open/apps/player/#=%s">https://ponyhacks.com/open/apps/player/#=%s</a>“,
~ “THoTplayer”);
~ }
~ protocolHandler() </p>

            </div>
            
        </li>
        
    </ul>
  </div>
</body>
</html>
